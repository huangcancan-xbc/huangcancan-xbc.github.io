<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>049 HTTPS 协议原理 | 小米里的大麦</title><meta name="keywords" content="Linux,网络"><meta name="author" content="小米里的大麦"><meta name="copyright" content="小米里的大麦"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="049 HTTPS 协议原理"><meta name="application-name" content="049 HTTPS 协议原理"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="049 HTTPS 协议原理"><meta property="og:url" content="https://www.minbit.top/posts/34998.html"><meta property="og:site_name" content="小米里的大麦"><meta property="og:description" content="HTTPS 协议原理 Linux：HTTPS 协议原理 | CSDN（荐） LINUX 网络基础 [六] - HTTPS 协议 | CSDN  先简单回顾一下 TCP&amp;#x2F;IP 四层模型（视频剩余部分可作为了解）：http 和 https 有什么区别吗？(SSL 协议) | B 站。 1. 概"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250314131841400.png?_r_=d20d13f8-c4a1-3018-7b57-dfc505aaf25a"><meta property="article:author" content="小米里的大麦"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250314131841400.png?_r_=d20d13f8-c4a1-3018-7b57-dfc505aaf25a"><meta name="description" content="HTTPS 协议原理 Linux：HTTPS 协议原理 | CSDN（荐） LINUX 网络基础 [六] - HTTPS 协议 | CSDN  先简单回顾一下 TCP&amp;#x2F;IP 四层模型（视频剩余部分可作为了解）：http 和 https 有什么区别吗？(SSL 协议) | B 站。 1. 概"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="https://www.minbit.top/posts/34998.html"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="Cd-RTVhRO2mndEhicN2cvLXbsNxPqFC6fSn6ql80eVg"/><meta name="baidu-site-verification" content="codeva-ZG3S9QTvGO"/><meta name="msvalidate.01" content="6DF744D82FE6D1FD11CE18658760B59D"/><meta name="baidu-site-verification" content="codeva-gIjOMzUuhV"/><link rel="manifest" href="/manifest.json"/><meta name="msapplication-TileColor" content="var(--anzhiyu-main)"/><link rel="mask-icon" href="/img/siteicon/apple-icon-180.png" color="#5bbad5"/><link rel="apple-touch-icon" sizes="180x180" href="/img/siteicon/apple-icon-180.png"/><link rel="apple-touch-icon-precomposed" sizes="180x180" href="/img/siteicon/apple-icon-180.png"/><link rel="icon" type="image/png" sizes="32x32" href="/img/siteicon/32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/img/siteicon/16.png"/><link rel="bookmark" href="/img/siteicon/apple-icon-180.png"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2048-2732.jpg" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2732-2048.jpg" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1668-2388.jpg" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2388-1668.jpg" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1536-2048.jpg" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2048-1536.jpg" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1668-2224.jpg" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2224-1668.jpg" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1620-2160.jpg" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2160-1620.jpg" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1290-2796.jpg" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2796-1290.jpg" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1179-2556.jpg" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2556-1179.jpg" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1284-2778.jpg" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2778-1284.jpg" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1170-2532.jpg" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2532-1170.jpg" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1125-2436.jpg" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2436-1125.jpg" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1242-2688.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2688-1242.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-828-1792.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1792-828.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1242-2208.jpg" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2208-1242.jpg" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-750-1334.jpg" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1334-750.jpg" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-640-1136.jpg" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1136-640.jpg" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: {"enable":true,"title":"友链 + 外链 + 无限进步！欢迎欣赏和贡献！","addFriendPlaceholder":"昵称（请勿包含博客等字样）：\n网站地址（要求博客地址，请勿提交个人主页）：\n头像图片url（请提供尽可能清晰的图片，我会上传到我自己的图床）：\n描述：\n站点截图（可选）：\n"},
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"小米里的大麦","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":4,"basicWordCount":1999,"key":"93d1622eadde491eb0594b68ade51723.kaEiDD6A3KPzb7xv","Referer":"https://www.minbit.top/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: {"enable":true,"ck":"Jp8wwGQpp21utaFQ","LingQueMonitorID":"Jp8ztDRrxmTf7LDj"},
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: 'https://twikoo-olive-one.vercel.app/',
  commentBarrageConfig:{"enable":true,"maxBarrage":10,"barrageTime":5000,"accessToken":"25c96851dd8a790c4819ad4bfbaf153c","mailMd5":"7b12ebc2be80f9159099f6ab0e16573c"},
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: {"mode":"both","api":"https://img2color-go.vercel.app/api?img=","cover_change":true},
  authorStatus: {"skills":["🧐 准备中，就快好了，真的！😭","📚 正在学习中，加油！","🎵 喜欢听音乐，喜欢看动漫"]},
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: 小米里的大麦","link":"链接: ","source":"来源: 小米里的大麦","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-right"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: '小米里的大麦',
  title: '049 HTTPS 协议原理',
  postAI: '这篇文章讲述了HTTPS协议的原理，它是一个应用层协议，是HTTP协议的安全版，通过引入加密层来解决HTTP协议明文传输的安全问题。文章详细介绍了加密的概念、必要性和常见的加密方式，包括对称加密和非对称加密，以及数据摘要和数字签名的应用。HTTPS协议通过结合非对称加密和对称加密，并利用数字证书和CA签名认证来确保通信的安全性和身份的可靠性，有效防御中间人攻击。文章还探讨了HTTPS协议的五种方案，并最终选择了非对称加密+对称加密+数字证书的混合方案，因为它既保证了效率又增强了安全性。最后，文章对HTTPS协议的一些扩展和思考进行了讨论，包括CA签名流程、数字签名的应用以及中间人攻击的几种真实场景。',
  pageFillDescription: 'HTTPS 协议原理, 1. 概念准备, 1. HTTPS 是什么？, 2. 什么是加密？, 3. 为什么要加密？, 4. 常见的加密方式, 1. 对称加密, 2. 非对称加密, 3. 数据摘要 ampamp 数据指纹, 4. 数字签名（后面细说）, 2. HTTPS 的 5 种方案探究, 方案 1：只使用对称加密, 1. 场景, 2. 密钥如何传输？, 3. 风险在哪里？, 4. 产生的问题, 方案 2：只使用非对称加密, 1. 场景, 2. 密钥如何传输？, 3. 风险在哪里？, 方案 3：双方都使用非对称加密, 1. 场景, 2. 密钥如何传输？, 3. 风险在哪里？, 4. 产生的问题, 方案 4：非对称加密 + 对称加密（混合方案）, 1. 场景, 2. 密钥如何传输？, 3. 风险在哪里？, 4. 优缺点, 方案 5（最终方案）非对称加密 + 对称加密 + 数字证书（HTTPS 真实方案）, 1. 场景, 2. 密钥如何传输？, 3. 如何防御中间人攻击？, 4. 补充安全机制（了解）, 5. 小结, 1. 为什么 HTTPS 最终选择这个方案？, 2. 附加：密钥被攻击的几种真实场景, 6. 理解链 - 承上启下, 1. 对 HTTP 进行对称加密是否能解决数据通信安全的问题？问题是什么？, 2. 为何要用非对称加密？, 3. 为何不全用非对称加密？, 4. CA 签名认证 VS 数字证书 VS 数字签名, 3. 关于 HTTPS 的一些扩展和思考, 1. CA 签名流程是不是先做摘要？, 2. 为什么数字签名（如 CA 对证书签名）不直接用私钥加密原始数据（如证书或任意文件）而要先对数据做 Hash 生成摘要再对摘要进行加密签名？, 3. 如何成为中间人（MITM）, 1. ARP 欺骗, 2. ICMP 重定向攻击, 3. 假 WiFi x2F 假网站, 4. HTTPS 中间人（需用户配合或证书漏洞）协议原理协议原理荐网络基础六协议先简单回顾一下四层模型视频剩余部分可作为了解和有什么区别吗协议站概念准备是什么是一个应用层协议可以理解为是协议的安全版核心区别在协议的基础上引入了一个加密层原因标准的协议是明文传输的这意味着传输的数据如账号密码个人信息在经过路由器运营商等网络设备时很容易被劫持或篡改例如运营商劫持下载链接目的通过加密保证用户的信息安全防止数据在传输过程中被窃取或篡改什么是加密加密将要传输的原始信息称为明文通过一系列数学变换生成一段不可读的看似随机的文本称为密文的过程解密将密文通过一系列变换还原成原始明文的过程密钥在加密和解密过程中需要用到一个或多个关键数据这个数据就叫做密钥它是加密算法的核心决定了加密和解密的具体方式为什么要加密主要原因是为了应对网络传输中的安全威胁特别是中间人攻击简称攻击明文传输的风险的明文数据在传输过程中会经过多个物理节点路由器运营商等任何能接触到这些节点的人都可以窃取我们的隐私信息如登录密码支付信息甚至可以篡改传输的内容如将运营商设备篡改下载链接等等加密的作用通过对信息进行加密即使数据被劫持黑客看到的也只是无法理解的密文从而保护了信息的机密性和完整性常见的加密方式下面这些视频我认为讲的非常好虽然标题各式各样的但是内容和我们要讲的基本一致超出的知识就当扩展了如果后面的文字讲解难懂建议先看视频是什么原理是什么用公钥加密为什么不能用公钥解密站是什么加密原理和证书握手过程站真的安全吗一个动画秒懂站白话如何在全世界的眼皮子底下安全密谋站真安全么抓包解密的两种原理实战开源软件与如何抓包站数字签名和数字证书的核心原理和作用站分钟弄懂概念与原理入门教程站对称加密原理使用同一个密钥进行加密和解密这个密钥必须由通信双方共同持有特点优点算法公开计算量小加密速度快效率高缺点最大的问题是密钥的分发如何安全地把这个共享密钥告诉对方如果通过网络明文传输密钥那么密钥本身就会被截获整个加密就形同虚设常见算法等简单示例按位异或操作用密钥对明文加密得到密文再用同一个密钥对密文解密就能得到明文非对称加密原理使用一对密钥一个公钥和一个私钥公钥和私钥是成对生成的它们之间有特殊的数学关系工作方式用公钥加密只能用对应的私钥解密用私钥加密这通常称为签名只能用对应的公钥解密这通常称为验证特点优点解决了密钥分发问题公钥可以公开给任何人而私钥自己严格保密即使公钥被截获没有私钥也无法解密缺点算法复杂加密和解密速度比对称加密慢很多常见算法等生活中的例子公钥就像一把锁可以公开分发任何人想给你发秘密文件就把文件放进盒子并用这把锁锁上只有你拥有对应的钥匙私钥才能打开盒子取出文件数据摘要数据指纹摘要就是把任意长度的数据通过函数变成一个定长的指纹或身份证对原始数据进行单向哈希运算后得到的一串固定长度的字符串能用来验证数据完整性数据指纹类似也是通过算法提取数据特征可用于识别和区分不同数据它们都像数据的独特标识数据摘要的特点不可逆从摘要推不回原文雪崩效应原文哪怕改个字节摘要都会完全不同长度固定无论原文多大都能快速生成摘要摘要结果都是固定长度比如位确定性相同输入相同输出抗碰撞性极难找到两个不同内容生成相同摘要防伪造数据摘要可以理解为原文一大堆内容摘要身份证号或指纹唯一标识这个内容改了就对不上原理利用单向散列函数函数如对任意长度的数据进行计算生成一个固定长度的唯一的数字指纹或摘要关键特性定长无论输入多长输出的摘要长度是固定的分散输入数据哪怕只改变一个比特生成的摘要也会发生巨大变化不可逆无法从摘要反推出原始数据防碰撞理论上不同的数据可能产生相同的摘要碰撞但概率极低用途严格来说这不是加密因为它没有解密过程它主要用于验证数据的完整性接收方可以自己计算收到数据的摘要然后与发送方提供的摘要进行比对如果一致说明数据在传输过程中没有被篡改数字签名后面细说原理数字签名数据摘要非对称加密对原始数据明文计算一个数据摘要使用发送方的私钥对这个摘要进行加密得到的结果就是数字签名验证过程接收方收到原始数据和数字签名用发送方的公钥解密数字签名得到一个摘要值我们称之为摘要接收方自己用相同的哈希算法对收到的原始数据计算摘要我们称之为摘要比较摘要和摘要如果相等则说明数据完整性数据未被篡改因为摘要匹配身份认证签名确实是由持有对应私钥的人生成的因为只有他的公钥才能成功解密作用数字签名解决了我是谁和内容是否被改过的问题的种方案探究对称加密加密和解密使用同一个密钥速度快适合大量数据加密非对称加密有一对密钥公钥可公开和私钥必须保密公钥加密的数据只有私钥能解密私钥签名的数据公钥可验证优点不怕公钥被截获缺点速度慢不适合大数据加密中间人攻击攻击者在通信双方中间截获篡改伪造信息方案只使用对称加密场景客户端和服务器约定用同一个密钥比如来加密通信密钥如何传输必须提前共享密钥比如客户端和服务器事先约定好密钥不现实互联网用户千千万或者客户端第一次访问时服务器明文发送密钥给客户端风险在哪里密钥在传输过程中被截获比如客户端请求请给我密钥服务器回复密钥是被黑客监听到之后所有通信黑客用解密完全裸奔产生的问题密钥无法安全传递除非物理见面不现实每个用户都要不同密钥服务器怎么管理一旦密钥泄露所有通信都暴露就像我们和朋友约好用同一把钥匙开保险箱但我们必须先把钥匙寄给他快递员黑客偷了钥匙就能开你的保险箱方案只使用非对称加密场景服务器有公钥和私钥客户端用服务器的公钥加密数据服务器用自己的私钥解密密钥如何传输服务器把自己的公钥发给客户端公钥不怕被截获客户端用公钥加密数据服务器用私钥解密风险在哪里性能问题无法双向加密性能极差非对称加密计算量大传个网页都要几秒用户体验爆炸服务器无法加密发给客户端客户端没有私钥服务器如果想加密数据发给客户端必须知道客户端的公钥但客户端没有公私钥对如果让客户端也生成公私钥那就变成方案了就像每次寄信都要用特制保险箱非对称加密寄一封信要花分钟打包收件人还要花分钟拆寄封信系统崩溃方案双方都使用非对称加密场景客户端和服务器各自生成自己的公私钥对互相交换公钥然后用对方的公钥加密数据发给对方密钥如何传输客户端生成公私钥把公钥发给服务器服务器生成公私钥把公钥发给客户端双方用对方公钥加密用自己的私钥解密风险在哪里中间人攻击黑客可以这样干客户端我要和服务器通信请给我公钥黑客截获伪造自己是服务器把自己的公钥发给客户端客户端用假公钥加密数据黑客收到后用自己的私钥解密再用真服务器的公钥加密转发服务器回复黑客同样截获用客户端的假公钥加密再发回去客户端和服务器以为在安全通信其实所有数据都被黑客看到并转发产生的问题无法确认公钥是谁的公钥被掉包都不知道性能依然差非对称加密慢管理复杂每个会话都要生成密钥对就像我们和朋友交换加密信箱钥匙但快递员偷偷把自己的钥匙塞给我们说这是我朋友的我寄信给他他全都能看再模仿我朋友回信我们完全被蒙在鼓里方案非对称加密对称加密混合方案方案在里常见但已经弃用现在都用椭圆曲线做密钥协商这样即使服务器长期私钥泄露历史流量也解不开前向保密换句话说对称密钥不是传输过来的而是双方独立算出来的场景用非对称加密来安全传递对称密钥之后用对称密钥加密通信数据密钥如何传输客户端连接服务器服务器发送自己的公钥比如通过证书客户端生成一个随机的对称密钥如密钥客户端用服务器的公钥加密这个对称密钥发送给服务器服务器用自己的私钥解密得到对称密钥之后所有通信都用这个对称密钥加密解密风险在哪里如果公钥是假的对称密钥就会被黑客截获还是中间人攻击黑客伪造服务器把自己的公钥发给客户端客户端生成对称密钥用假公钥加密黑客用自己的私钥解密得到真实对称密钥黑客再用真服务器的公钥加密对称密钥发给服务器之后所有通信黑客都能用对称密钥解密问题根源客户端无法确认收到的公钥是不是真的属于目标服务器优缺点优点对称加密快适合大数据非对称只用于传密钥计算量小缺点公钥真实性无法保证需要身份认证就像我们用防弹车非对称加密把保险箱钥匙对称密钥送到朋友家但送错了地址假服务器钥匙被坏人拿到之后我们寄的所有东西他都能打开方案最终方案非对称加密对称加密数字证书真实方案场景在方案基础上加入数字证书来验证服务器公钥的真实性密钥如何传输客户端发起请求服务器返回数字证书包含服务器公钥服务器身份信息签名客户端验证证书用操作系统浏览器内置的公钥验证证书签名是否合法检查证书是否过期域名是否匹配等如果验证失败浏览器弹出警告客户端生成随机对称密钥如客户端用证书里的服务器公钥加密对称密钥发送给服务器服务器用自己的私钥解密得到对称密钥之后所有通信都用对称密钥加密高效安全如何防御中间人攻击数字证书由可信第三方签名黑客无法伪造合法证书黑客即使拦截通信也无法伪造一个被签名的证书除非攻破极难客户端会校验证书发现域名不符或签名无效直接终止连接补充安全机制了解前向保密每次会话生成临时密钥即使服务器私钥未来泄露历史会话也无法解密通过等密钥交换算法实现证书吊销机制应对私钥泄露或证书被盗用小结方案加密方式密钥传输方式主要风险是否可行方案对称加密明文传输或预共享密钥被截获全部暴露不可行方案非对称加密公钥公开传输性能差无法双向加密不实用方案双方非对称交换公钥中间人攻击公钥被替换掉包不安全方案非对称对称混合加密用公钥加密对称密钥中间人攻击公钥未认证截获有漏洞最终方案混合证书用认证公钥加密对称密钥依赖体系保障极少数被攻破案例安全高效之前看到的一个很形象易理解的比喻想象你要和朋友安全通信方案你俩约好用同一把钥匙但你得先寄给他快递员偷了钥匙完蛋方案每次说话都用特制密码机太慢聊两句就卡死方案你俩交换密码机的公开使用说明但快递员把自己的说明书冒充你朋友的你按他的说明书操作他在偷听方案你寄一把普通钥匙但用朋友的防伪密码箱寄但如果防伪密码箱是假的快递员给的钥匙还是被偷最终方案朋友的防伪密码箱上有公安局盖章认证证书你一看盖章是真的才放心寄钥匙安全为什么最终选择这个方案效率高对称加密处理海量数据安全强非对称加密保护密钥传输身份可信证书防止公钥被伪造可扩展支持前向保密吊销多域名等附加密钥被攻击的几种真实场景私钥泄露服务器被入侵攻击者可解密历史通信除非启用前向保密被攻破攻击者可签发任意假证书极罕见如事件用户忽略证书警告主动接受假证书中间人攻击成功弱随机数生成器生成的对称密钥可预测被破解理解链承上启下对进行对称加密是否能解决数据通信安全的问题问题是什么不能完全解决核心问题密钥的分发假设客户端和服务器都用同一个对称密钥来加密通信这确实能防止第三方窃听但是这个密钥是如何从服务器安全地传递给客户端的呢如果在连接建立之初服务器直接把密钥明文发给客户端那么中间人黑客同样可以截获这个密钥一旦密钥泄露后续所有的加密通信对中间人来说就等于没有加密这就陷入了先有鸡还是先有蛋的困境为了安全传输密钥我们需要一个密钥来加密它但这个用来加密密钥的密钥又该如何安全传输呢为何要用非对称加密为了解决密钥分发问题非对称加密的特性公钥加密私钥解密完美地解决了这个问题服务器可以将自己的公钥通过明文的方式发送给客户端客户端用这个公钥加密一个对称密钥后发送给服务器即使中间人截获了这个加密后的对称密钥他也无法解密因为他没有服务器的私钥只有服务器能用自己的私钥解密从而安全地获得对称密钥为何不全用非对称加密主要原因是性能非对称加密的算法非常复杂其加密和解密的速度远远慢于对称加密如果整个通信过程都使用非对称加密会极大地消耗服务器和客户端的计算资源导致网页加载速度变慢用户体验很差因此最佳实践是结合两者使用非对称加密来安全地协商一个临时的对称密钥然后在后续的大量数据传输中使用这个对称密钥进行高效加密这就是的核心工作原理签名认证数字证书数字签名数字签名数字证书签名认证这三样东西经常被混在一起说但它们不是一个东西而是三个环环相扣的概念签名认证产生合法的数字证书证书里面包含数字签名数字签名就是用私钥对一段数据做的签名任何人都能用对应的公钥验证签名是否有效用途保证数据没有被篡改完整性保证数据确实是私钥持有者发的身份认证简单例子服务器把自己的公钥信息域名信息打个包用私钥生成一个签名客户端用服务器的公钥验证签名能验证这份数据确实出自服务器本人类比数字签名手写签名盖章别人可以看到签名验证是你签的但没法伪造数字证书一份带身份证明的公钥里面包含服务器的公钥服务器的域名信息比如有效期用途等信息还有一个数字签名由生成的用途客户端拿到证书后不仅知道这是公钥还知道这个公钥是属于哪个网站的解决了公钥是谁的这个问题类比数字证书身份证身份证上写着你的名字域名照片公钥还有公安局的盖章签名签名认证就是证书里的盖章部分证书不是服务器自己随便说这是我的身份证而是交给权威机构证书颁发机构去验证然后用自己的私钥签名证明这份证书是真的流程服务器提交公钥域名信息给审核域名验证公司验证等用自己的私钥对证书做数字签名浏览器内置了各大的公钥可以验证证书签名是否有效用途确保证书是真的不是黑客自己伪造的确认公钥确实属于类比签名认证公安局给身份证盖章别人一看章是真的就知道身份证不是假造的关于的一些扩展和思考签名流程是不是先做摘要是的在给证书签名时先对证书内容域名公钥有效期等做得到摘要再用私钥加密摘要得到数字签名把签名原始证书信息一起发送给客户端证书明文信息签名签名用私钥加密数据的摘要浏览器验证时先用相同算法对证书内容再用公钥解密签名得到摘要两者对比确认证书没被篡改为什么数字签名如对证书签名不直接用私钥加密原始数据如证书或任意文件而要先对数据做生成摘要再对摘要进行加密签名因为直接用私钥加密原始数据效率极低非对称加密计算慢且受数据长度限制不适合大文件或频繁操作而先对数据做生成固定长度的摘要再加密摘要既大幅提升签名速度又保证了安全性更重要的是摘要具备雪崩效应和抗篡改性哪怕原文改动一个字节摘要也会彻底改变接收方通过比对摘要即可验证完整性同时先还能防御长度扩展攻击等密码学漏洞确保签名机制在各种场景下如证书文件消息都安全高效标准化所以标准流程原文摘要用私钥加密签名客户端验证时收到原文签名原文重新用公钥解密签名摘要两个摘要比对一致证明原文没改签名有效如何成为中间人欺骗局域网里电脑通信需要知道对方的地址地址解析协议就是负责地址绑定漏洞没有验证机制谁说自己是某个就信攻击方法黑客冒充别人主机想访问主机先广播的地址谁知道黑客抢答我是我的是结果把流量都发给黑客黑客再转发给黑客变中间人就像在班里传纸条想传给黑客插话说我就是把纸条给我再偷偷看一眼转交给真重定向攻击协议里有一种重定向消息路由器可以告诉主机嘿这个目标地址你应该走另一条更好的路漏洞没验证谁都能发攻击方法黑客伪造消息告诉受害者要访问外网请经过我这台路由器结果受害者的所有流量都经过黑客机器就像问路路人甲黑客冒充警察说你要去市中心从我家后门穿过去更快结果你绕进了陷阱假假网站假所谓的钓鱼网络黑客开个和真同名的热点用户连上去后所有流量都经过黑客电脑可以监控篡改数据假网站黑客在局域网或劫持把映射到自己控制的假服务器用户以为在访问银行其实是黑客的钓鱼网站就像黑客开了一家假银行外观和真的一样但柜员全是演员用户输入账号密码就等于都交给了他本质中间人就是把流量骗到自己手里再决定是只偷听还是修改后转发中间人需用户配合或证书漏洞原理伪造证书骗浏览器信任操作黑客作为中间人拦截请求伪造一个假证书发给客户端如自签名或盗用如果用户点击继续访问不安全则攻击成功防御浏览器会警告证书不受信任我们用户不点忽略就攻不破',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-08-28 12:00:00',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 10 || hour >= 20
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://github.com/huangcancan-xbc/Drawing-bed/blob/master/Blog/20250307201719879.png?raw=true"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">社交</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://github.com/huangcancan-xbc" title="GitHub"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="GitHub"/><span class="back-menu-item-text">GitHub</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://space.bilibili.com/1918272544" title="哔哩哔哩"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="哔哩哔哩"/><span class="back-menu-item-text">哔哩哔哩</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://gitee.com/huang-cancan-xbc" title="Gitee"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="Gitee"/><span class="back-menu-item-text">Gitee</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">博客</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.csdn.net/Huangcancan666?type=blog" title="CSDN"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="CSDN"/><span class="back-menu-item-text">CSDN</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://juejin.cn/user/3230789931118109" title="稀土掘金"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="稀土掘金"/><span class="back-menu-item-text">稀土掘金</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">小米里的大麦</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/charts/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 统计</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 外链</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li></ul></div></div></div><div id="nav-right"><div id="nav-naoDark"><div class="container"><div class="components"><div class="main-button"><div class="moon"></div><div class="moon"></div><div class="moon"></div></div><div class="daytime-backgrond"></div><div class="daytime-backgrond"></div><div class="daytime-backgrond"></div><div class="cloud"><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div></div><div class="cloud-light"><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div></div><div class="stars"><div class="star big"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star big"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star medium"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star medium"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star small"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star small"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div></div></div></div></div><div class="nav-button only-home" id="travellings_button" title="随机前往一个开往项目网站"><a class="site-page" onclick="anzhiyu.totraveling()" title="随机前往一个开往项目网站" href="javascript:void(0);" rel="external nofollow" data-pjax-state="external"><i class="anzhiyufont anzhiyu-icon-train"></i></a></div><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250403212543768.png" target="_blank"><img class="post-qr-code-img" alt="微信" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250403212543768.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250403212622868.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250403212622868.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/C/" style="font-size: 1.05rem;">C++<sup>8</sup></a><a href="/tags/Git/" style="font-size: 1.05rem;">Git<sup>3</sup></a><a href="/tags/IO/" style="font-size: 1.05rem;">IO<sup>3</sup></a><a href="/tags/Linux/" style="font-size: 1.05rem;">Linux<sup>50</sup></a><a href="/tags/Obsidian/" style="font-size: 1.05rem;">Obsidian<sup>1</sup></a><a href="/tags/STL/" style="font-size: 1.05rem;">STL<sup>2</sup></a><a href="/tags/VS-Code/" style="font-size: 1.05rem;">VS Code<sup>1</sup></a><a href="/tags/%E4%BF%A1%E5%8F%B7/" style="font-size: 1.05rem;">信号<sup>3</sup></a><a href="/tags/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/" style="font-size: 1.05rem;">内存管理<sup>1</sup></a><a href="/tags/%E5%8E%86%E7%A8%8B/" style="font-size: 1.05rem;">历程<sup>1</sup></a><a href="/tags/%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4/" style="font-size: 1.05rem;">地址空间<sup>6</sup></a><a href="/tags/%E6%95%B0%E5%AD%A6/" style="font-size: 1.05rem;">数学<sup>1</sup></a><a href="/tags/%E6%A8%A1%E6%9D%BF/" style="font-size: 1.05rem;">模板<sup>1</sup></a><a href="/tags/%E7%AE%A1%E9%81%93/" style="font-size: 1.05rem;">管道<sup>2</sup></a><a href="/tags/%E7%B1%BB%E4%B8%8E%E5%AF%B9%E8%B1%A1/" style="font-size: 1.05rem;">类与对象<sup>3</sup></a><a href="/tags/%E7%BA%BF%E7%A8%8B/" style="font-size: 1.05rem;">线程<sup>4</sup></a><a href="/tags/%E7%BD%91%E7%AB%99/" style="font-size: 1.05rem;">网站<sup>2</sup></a><a href="/tags/%E7%BD%91%E7%BB%9C/" style="font-size: 1.05rem;">网络<sup>6</sup></a><a href="/tags/%E8%BF%9B%E7%A8%8B/" style="font-size: 1.05rem;">进程<sup>15</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="anzhiyufont anzhiyu-icon-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/09/"><span class="card-archive-list-date">九月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/08/"><span class="card-archive-list-date">八月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">8</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/07/"><span class="card-archive-list-date">七月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">9</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/06/"><span class="card-archive-list-date">六月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">6</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/05/"><span class="card-archive-list-date">五月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">9</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/04/"><span class="card-archive-list-date">四月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">8</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/03/"><span class="card-archive-list-date">三月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">10</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/02/"><span class="card-archive-list-date">二月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">9</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item on" id="consoleCommentBarrage" onclick="anzhiyu.switchCommentBarrage()" title="热评开关"><a class="commentBarrage"><i class="anzhiyufont anzhiyu-icon-message"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div><div id="console-naoDark"><div class="container"><div class="components"><div class="main-button"><div class="moon"></div><div class="moon"></div><div class="moon"></div></div><div class="daytime-backgrond"></div><div class="daytime-backgrond"></div><div class="daytime-backgrond"></div><div class="cloud"><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div></div><div class="cloud-light"><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div></div><div class="stars"><div class="star big"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star big"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star medium"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star medium"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star small"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star small"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div></div></div></div></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/Linux/" itemprop="url">Linux</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/Linux/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Linux</span></a><a class="article-meta__tags" href="/tags/%E7%BD%91%E7%BB%9C/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>网络</span></a></span></div></div><h1 class="post-title" itemprop="name headline">049 HTTPS 协议原理</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2025-08-28T04:00:00.000Z" title="发表于 2025-08-28 12:00:00">2025-08-28</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2025-08-28T04:00:00.000Z" title="更新于 2025-08-28 12:00:00">2025-08-28</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">6.6k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>19分钟</span></span><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="049 HTTPS 协议原理"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为西安"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>西安</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250314131841400.png?_r_=d20d13f8-c4a1-3018-7b57-dfc505aaf25a"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><div class="post-ai-description"><div class="ai-title"><i class="anzhiyufont anzhiyu-icon-bilibili"></i><div class="ai-title-text">AI-摘要</div><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right"></i><i class="anzhiyufont anzhiyu-icon-circle-dot" title="朗读摘要"></i><div id="ai-tag">小米里的大麦 GPT</div></div><div class="ai-explanation">AI初始化中...</div><div class="ai-btn-box"><div class="ai-btn-item">介绍自己 🙈</div><div class="ai-btn-item">生成本文简介 👋</div><div class="ai-btn-item">推荐相关文章 📖</div><div class="ai-btn-item">前往主页 🏠</div><div class="ai-btn-item" id="go-tianli-blog">前往爱发电购买</div></div><script data-pjax src="/js/anzhiyu/ai_abstract.js"></script></div><article class="post-content" id="article-container" itemscope itemtype="https://www.minbit.top/posts/34998.html"><header><a class="post-meta-categories" href="/categories/Linux/" itemprop="url">Linux</a><a href="/tags/Linux/" tabindex="-1" itemprop="url">Linux</a><a href="/tags/%E7%BD%91%E7%BB%9C/" tabindex="-1" itemprop="url">网络</a><h1 id="CrawlerTitle" itemprop="name headline">049 HTTPS 协议原理</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">小米里的大麦</span><time itemprop="dateCreated datePublished" datetime="2025-08-28T04:00:00.000Z" title="发表于 2025-08-28 12:00:00">2025-08-28</time><time itemprop="dateCreated datePublished" datetime="2025-08-28T04:00:00.000Z" title="更新于 2025-08-28 12:00:00">2025-08-28</time></header><h1 id="HTTPS-协议原理"><a href="#HTTPS-协议原理" class="headerlink" title="HTTPS 协议原理"></a>HTTPS 协议原理</h1><blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_51142926/article/details/143697206">Linux：HTTPS 协议原理 | CSDN（荐）</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/2402_83315537/article/details/147430000">LINUX 网络基础 [六] - HTTPS 协议 | CSDN</a></p>
</blockquote>
<p>先简单回顾一下 TCP&#x2F;IP 四层模型（视频剩余部分可作为了解）：<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Wf4y1E7qs/?share_source=copy_web&vd_source=872e5e3ccf44874c39edaf42e30ab0de">http 和 https 有什么区别吗？(SSL 协议) | B 站</a>。</p>
<h2 id="1-概念准备"><a href="#1-概念准备" class="headerlink" title="1. 概念准备"></a>1. 概念准备</h2><h3 id="1-HTTPS-是什么？"><a href="#1-HTTPS-是什么？" class="headerlink" title="1. HTTPS 是什么？"></a>1. HTTPS 是什么？</h3><p>HTTPS（HyperText Transfer Protocol Secure）是一个 <strong>应用层协议</strong>，可以理解为是 HTTP 协议的“安全版”。</p>
<ul>
<li><strong>核心区别</strong>：在 HTTP 协议的基础上引入了一个 <strong>加密层</strong>。</li>
<li><strong>原因</strong>：标准的 HTTP 协议是 <strong>明文传输</strong> 的，这意味着传输的数据（如账号、密码、个人信息）在经过路由器、运营商等网络设备时，很容易被“劫持”或“篡改”（例如“运营商劫持”下载链接）。</li>
<li><strong>目的</strong>：通过加密，保证用户的信息安全，防止数据在传输过程中被窃取或篡改。</li>
</ul>
<h3 id="2-什么是加密？"><a href="#2-什么是加密？" class="headerlink" title="2. 什么是加密？"></a>2. 什么是加密？</h3><ul>
<li><strong>加密</strong>：将要传输的原始信息（称为 <strong>明文</strong>）通过一系列数学变换，生成一段不可读的、看似随机的文本（称为 <strong>密文</strong>）的过程。</li>
<li><strong>解密</strong>：将 <strong>密文</strong> 通过一系列变换，还原成原始 <strong>明文</strong> 的过程。</li>
<li><strong><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%AF%86%E9%92%A5/101144?fromModule=lemma_inlink">密钥</a></strong>：在加密和解密过程中，需要用到一个或多个关键数据，这个数据就叫做 <strong>密钥</strong>。它是加密算法的核心，决定了加密和解密的具体方式。</li>
</ul>
<h3 id="3-为什么要加密？"><a href="#3-为什么要加密？" class="headerlink" title="3. 为什么要加密？"></a>3. 为什么要加密？</h3><p>主要原因是为了应对网络传输中的安全威胁，特别是 <strong>中间人攻击（Man-in-the-Middle Attack, 简称 MITM 攻击）</strong>。</p>
<ul>
<li><strong>明文传输的风险</strong>：HTTP 的明文数据在传输过程中会经过多个物理节点（路由器、运营商等）。任何能接触到这些节点的人都可以 <strong>窃取</strong> 我们的隐私信息（如登录密码、支付信息），甚至可以 <strong>篡改</strong> 传输的内容（如将运营商设备篡改下载链接等等）。</li>
<li><strong>加密的作用</strong>：通过对信息进行加密，即使数据被劫持，黑客看到的也只是无法理解的密文，从而保护了信息的机密性和完整性。</li>
</ul>
<h3 id="4-常见的加密方式"><a href="#4-常见的加密方式" class="headerlink" title="4. 常见的加密方式"></a>4. 常见的加密方式</h3><blockquote>
<p>下面这些视频我认为讲的非常好，虽然标题各式各样的，但是内容和我们要讲的基本一致，超出的知识就当扩展了，<strong>如果后面的文字讲解难懂，建议先看视频</strong> 👉：</p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1RT411272Y/?share_source=copy_web&vd_source=872e5e3ccf44874c39edaf42e30ab0de">HTTPS 是什么?原理是什么？用公钥加密为什么不能用公钥解密？ | B 站</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1KY411x7Jp/?share_source=copy_web&vd_source=872e5e3ccf44874c39edaf42e30ab0de">HTTPS 是什么？加密原理和证书。SSL&#x2F;TLS 握手过程 | B 站</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1P5k3YHEGo/?share_source=copy_web&vd_source=872e5e3ccf44874c39edaf42e30ab0de">HTTPS 真的安全吗，一个动画秒懂！ | B 站</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1tAKozuEkd/?share_source=copy_web&vd_source=872e5e3ccf44874c39edaf42e30ab0de">白话 HTTPS，如何在全世界的眼皮子底下安全密谋？ | B 站</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1w7ADeLEPE/?share_source=copy_web&vd_source=872e5e3ccf44874c39edaf42e30ab0de">https 真安全么？ 抓包解密 https 的两种原理+实战  开源软件 mitmproxy 与 wireshark 如何抓包 https | B 站</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1mj421d7VE/?share_source=copy_web&vd_source=872e5e3ccf44874c39edaf42e30ab0de">数字签名和 CA 数字证书的核心原理和作用 B 站</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1FX4y1C76v/?share_source=copy_web&vd_source=872e5e3ccf44874c39edaf42e30ab0de">12 分钟弄懂 HTTPS 概念与原理 &#x2F; HTTPS 入门教程 | B 站</a></p>
</blockquote>
<h4 id="1-对称加密"><a href="#1-对称加密" class="headerlink" title="1. 对称加密"></a>1. 对称加密</h4><ul>
<li><strong>原理</strong>：使用 <strong>同一个密钥</strong> 进行加密和解密。这个密钥必须由通信双方共同持有。</li>
<li><strong>特点</strong>：<ul>
<li><strong>优点</strong>：算法公开、计算量小、<strong>加密速度快、效率高</strong>。</li>
<li><strong>缺点</strong>：最大的问题是 <strong>密钥的分发</strong>。如何安全地把这个“共享密钥”告诉对方？如果通过网络明文传输密钥，那么密钥本身就会被截获，整个加密就形同虚设。</li>
</ul>
</li>
<li><strong>常见算法</strong>：DES、3DES、AES 等。</li>
<li><strong>简单示例</strong>：按位异或（XOR）操作。用密钥 <code>key</code> 对明文 <code>a</code> 加密得到密文 <code>b</code>（<code>a ^ key = b</code>），再用同一个密钥 <code>key</code> 对密文 <code>b</code> 解密就能得到明文 <code>a</code>（<code>b ^ key = a</code>）。</li>
</ul>
<h4 id="2-非对称加密"><a href="#2-非对称加密" class="headerlink" title="2. 非对称加密"></a>2. 非对称加密</h4><ul>
<li><strong>原理</strong>：使用 <strong>一对</strong> 密钥，一个 **公钥 ** 和一个 <strong>私钥</strong>。公钥和私钥是成对生成的，它们之间有特殊的数学关系。</li>
<li><strong>工作方式</strong>：<ul>
<li>用 <strong>公钥</strong> 加密，只能用对应的 <strong>私钥</strong> 解密。</li>
<li>用 <strong>私钥</strong> 加密（这通常称为“签名”），只能用对应的 <strong>公钥</strong> 解密（这通常称为“验证”）。</li>
</ul>
</li>
<li><strong>特点</strong>：<ul>
<li><strong>优点</strong>：解决了密钥分发问题。公钥可以公开给任何人，而私钥自己严格保密。即使公钥被截获，没有私钥也无法解密。</li>
<li><strong>缺点</strong>：算法复杂，<strong>加密和解密速度比对称加密慢很多</strong>。</li>
</ul>
</li>
<li><strong>常见算法</strong>：RSA、DSA、ECDSA 等。</li>
<li><strong>生活中的例子</strong>：公钥就像一把 <strong>锁</strong>，可以公开分发。任何人想给你发秘密文件，就把文件放进盒子并用这把“锁”锁上。只有你拥有对应的“钥匙”（私钥），才能打开盒子取出文件。</li>
</ul>
<h4 id="3-数据摘要-数据指纹"><a href="#3-数据摘要-数据指纹" class="headerlink" title="3. 数据摘要 &amp;&amp; 数据指纹"></a>3. 数据摘要 &amp;&amp; 数据指纹</h4><blockquote>
<p><strong>摘要</strong> 就是把 <strong>任意长度的数据</strong>，通过 <strong>Hash 函数</strong> 变成一个 <strong>定长的“指纹”或“身份证”（对原始数据进行单向哈希运算后得到的一串固定长度的字符串）</strong>，能用来验证数据完整性；数据指纹类似，也是通过算法提取数据特征，可用于识别和区分不同数据，它们都像数据的独特 “标识”。</p>
<p><strong>数据摘要的特点：</strong></p>
<ul>
<li><strong>不可逆</strong>：从摘要推不回原文。</li>
<li><strong>雪崩效应</strong>：原文哪怕改 1 个字节，摘要都会完全不同。</li>
<li><strong>长度固定</strong>：无论原文多大，都能快速生成摘要，摘要结果都是固定长度（比如 256 位）。</li>
<li><strong>确定性</strong>：相同输入 → 相同输出。</li>
<li><strong>抗碰撞性</strong>：极难找到两个不同内容生成相同摘要（防伪造）。</li>
</ul>
<p><strong>数据摘要可以理解为：原文 &#x3D; 一大堆内容，摘要 &#x3D; “身份证号” 或 “指纹”（唯一标识这个内容，改了就对不上）。</strong></p>
</blockquote>
<ul>
<li><strong>原理</strong>：利用 <strong>单向散列函数</strong>（Hash 函数，如 <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/MD5"><strong>MD5</strong></a>、SHA1、SHA256）对任意长度的数据进行计算，生成一个 <strong>固定长度</strong> 的、唯一的“数字指纹”或“摘要”。</li>
<li><strong>关键特性</strong>：<ul>
<li><strong>定长</strong>：无论输入多长，输出的摘要长度是固定的。</li>
<li><strong>分散</strong>：输入数据哪怕只改变一个比特，生成的摘要也会发生巨大变化。</li>
<li><strong>不可逆</strong>：无法从摘要反推出原始数据。</li>
<li><strong>防碰撞</strong>：理论上不同的数据可能产生相同的摘要（碰撞），但概率极低。</li>
</ul>
</li>
<li><strong>用途</strong>：<strong>严格来说，这不是加密</strong>，因为它没有解密过程。它主要用于 <strong>验证数据的完整性</strong>。接收方可以自己计算收到数据的摘要，然后与发送方提供的摘要进行比对。如果一致，说明数据在传输过程中没有被篡改。</li>
</ul>
<h4 id="4-数字签名（后面细说）"><a href="#4-数字签名（后面细说）" class="headerlink" title="4. 数字签名（后面细说）"></a>4. 数字签名（后面细说）</h4><ul>
<li><strong>原理</strong>：数字签名 &#x3D; <strong>数据摘要 + 非对称加密</strong>。<ol>
<li>对原始数据（明文）计算一个 <strong>数据摘要</strong>。</li>
<li>使用发送方的 <strong>私钥</strong> 对这个 <strong>摘要</strong> 进行加密，得到的结果就是 <strong>数字签名</strong>。</li>
</ol>
</li>
<li><strong>验证过程</strong>：<ol>
<li>接收方收到原始数据和数字签名。</li>
<li>用发送方的 <strong>公钥</strong> 解密数字签名，得到一个摘要值（我们称之为 <code>摘要A</code>）。</li>
<li>接收方自己用相同的哈希算法对收到的原始数据计算摘要（我们称之为 <code>摘要B</code>）。</li>
<li>比较 <code>摘要A</code> 和 <code>摘要B</code>。如果相等，则说明：<ul>
<li><strong>数据完整性</strong>：数据未被篡改（因为摘要匹配）。</li>
<li><strong>身份认证</strong>：签名确实是由持有对应私钥的人生成的（因为只有他的公钥才能成功解密）。</li>
</ul>
</li>
</ol>
</li>
<li><strong>作用</strong>：数字签名解决了“<strong>我是谁</strong>”和“<strong>内容是否被改过</strong>”的问题。</li>
</ul>
<hr>
<h2 id="2-HTTPS-的-5-种方案探究"><a href="#2-HTTPS-的-5-种方案探究" class="headerlink" title="2. HTTPS 的 5 种方案探究"></a>2. HTTPS 的 5 种方案探究</h2><blockquote>
<ul>
<li><p><strong>对称加密</strong>：加密和解密使用同一个密钥。速度快，适合大量数据加密。</p>
</li>
<li><p><strong>非对称加密</strong>：有一对密钥 —— 公钥（可公开）和私钥（必须保密）。公钥加密的数据，只有私钥能解密；私钥签名的数据，公钥可验证。优点：不怕公钥被截获；缺点：速度慢，不适合大数据加密。</p>
</li>
<li><p><strong>中间人攻击（MITM）</strong>：攻击者在通信双方中间截获、篡改、伪造信息。</p>
</li>
</ul>
</blockquote>
<h3 id="方案-1：只使用对称加密"><a href="#方案-1：只使用对称加密" class="headerlink" title="方案 1：只使用对称加密"></a>方案 1：只使用对称加密</h3><h4 id="1-场景"><a href="#1-场景" class="headerlink" title="1. 场景"></a>1. 场景</h4><p>客户端和服务器约定用同一个密钥（比如 “123456”）来加密通信。</p>
<h4 id="2-密钥如何传输？"><a href="#2-密钥如何传输？" class="headerlink" title="2. 密钥如何传输？"></a>2. 密钥如何传输？</h4><p>必须提前“共享”密钥。比如：客户端和服务器事先约定好密钥（不现实，互联网用户千千万），或者，客户端第一次访问时，服务器“明文发送”密钥给客户端。</p>
<h4 id="3-风险在哪里？"><a href="#3-风险在哪里？" class="headerlink" title="3. 风险在哪里？"></a>3. 风险在哪里？</h4><p><strong>密钥在传输过程中被截获！</strong> 比如：客户端请求：“请给我密钥”，服务器回复：“密钥是 123456” ← 被黑客监听到，之后所有通信，黑客用 123456 解密 → <strong>完全裸奔！</strong></p>
<h4 id="4-产生的问题"><a href="#4-产生的问题" class="headerlink" title="4. 产生的问题"></a>4. 产生的问题</h4><p>密钥无法安全传递（除非物理见面，不现实），每个用户都要不同密钥？服务器怎么管理？一旦密钥泄露，所有通信都暴露。</p>
<blockquote>
<p> 就像我们和朋友约好用同一把钥匙开保险箱，但我们必须先把钥匙寄给他 —— 快递员（黑客）偷了钥匙，就能开你的保险箱。</p>
</blockquote>
<h3 id="方案-2：只使用非对称加密"><a href="#方案-2：只使用非对称加密" class="headerlink" title="方案 2：只使用非对称加密"></a>方案 2：只使用非对称加密</h3><h4 id="1-场景-1"><a href="#1-场景-1" class="headerlink" title="1. 场景"></a>1. 场景</h4><p>服务器有公钥和私钥。客户端用服务器的公钥加密数据，服务器用自己的私钥解密。</p>
<h4 id="2-密钥如何传输？-1"><a href="#2-密钥如何传输？-1" class="headerlink" title="2. 密钥如何传输？"></a>2. 密钥如何传输？</h4><p>服务器把自己的 <strong>公钥</strong> 发给客户端（公钥不怕被截获）→ 客户端用公钥加密数据 → 服务器用私钥解密。</p>
<h4 id="3-风险在哪里？-1"><a href="#3-风险在哪里？-1" class="headerlink" title="3. 风险在哪里？"></a>3. 风险在哪里？</h4><p><strong>性能问题 + 无法双向加密：</strong></p>
<ol>
<li><strong>性能极差</strong>：非对称加密计算量大，传个网页都要几秒，用户体验爆炸。</li>
<li><strong>服务器无法加密发给客户端</strong>：客户端没有私钥，服务器如果想加密数据发给客户端，必须知道客户端的公钥 —— 但客户端没有公私钥对！如果让客户端也生成公私钥，那就变成方案 3 了。</li>
</ol>
<blockquote>
<p>就像每次寄信都要用特制保险箱（非对称加密），寄一封信要花 10 分钟打包，收件人还要花 10 分钟拆 —— 寄 100 封信？系统崩溃！</p>
</blockquote>
<h3 id="方案-3：双方都使用非对称加密"><a href="#方案-3：双方都使用非对称加密" class="headerlink" title="方案 3：双方都使用非对称加密"></a>方案 3：双方都使用非对称加密</h3><h4 id="1-场景-2"><a href="#1-场景-2" class="headerlink" title="1. 场景"></a>1. 场景</h4><p>客户端和服务器各自生成自己的公私钥对。互相交换公钥，然后用对方的公钥加密数据发给对方。</p>
<h4 id="2-密钥如何传输？-2"><a href="#2-密钥如何传输？-2" class="headerlink" title="2. 密钥如何传输？"></a>2. 密钥如何传输？</h4><p>客户端生成公私钥，把公钥发给服务器 → 服务器生成公私钥，把公钥发给客户端 → 双方用对方公钥加密，用自己的私钥解密。</p>
<h4 id="3-风险在哪里？-2"><a href="#3-风险在哪里？-2" class="headerlink" title="3. 风险在哪里？"></a>3. 风险在哪里？</h4><p><strong>中间人攻击（MITM）！</strong> 黑客可以这样干：</p>
<ol>
<li>客户端 → “我要和服务器通信，请给我公钥”。</li>
<li>黑客截获，伪造自己是服务器，把自己的公钥发给客户端。</li>
<li>客户端 → 用“假公钥”加密数据 → 黑客收到后用自己的私钥解密 → 再用真服务器的公钥加密转发。</li>
<li>服务器 → 回复，黑客同样截获 → 用客户端的假公钥加密再发回去。</li>
</ol>
<p><strong>客户端和服务器以为在安全通信，其实所有数据都被黑客看到并转发！</strong></p>
<h4 id="4-产生的问题-1"><a href="#4-产生的问题-1" class="headerlink" title="4. 产生的问题"></a>4. 产生的问题</h4><ul>
<li>无法确认“公钥是谁的” —— 公钥被掉包都不知道！  </li>
<li>性能依然差（非对称加密慢）  </li>
<li>管理复杂（每个会话都要生成密钥对）</li>
</ul>
<blockquote>
<p>就像我们和朋友交换“加密信箱钥匙”，但快递员偷偷把自己的钥匙塞给我们，说“这是我朋友的”。我寄信给他，他全都能看，再模仿我朋友回信 —— 我们完全被蒙在鼓里！</p>
</blockquote>
<h3 id="方案-4：非对称加密-对称加密（混合方案）"><a href="#方案-4：非对称加密-对称加密（混合方案）" class="headerlink" title="方案 4：非对称加密 + 对称加密（混合方案）"></a>方案 4：非对称加密 + 对称加密（混合方案）</h3><blockquote>
<p>方案 4 在 TLS 1.2 里常见，但 TLS 1.3 已经弃用。现在都用 ECDHE（椭圆曲线 Diffie-Hellman Ephemeral） 做 密钥协商，这样即使服务器长期私钥泄露，历史流量也解不开（前向保密）。换句话说：<strong>对称密钥不是传输过来的，而是双方独立算出来的。</strong></p>
</blockquote>
<h4 id="1-场景-3"><a href="#1-场景-3" class="headerlink" title="1. 场景"></a>1. 场景</h4><p>用非对称加密来 <strong>安全传递对称密钥</strong>，之后用对称密钥加密通信数据。</p>
<h4 id="2-密钥如何传输？-3"><a href="#2-密钥如何传输？-3" class="headerlink" title="2. 密钥如何传输？"></a>2. 密钥如何传输？</h4><ol>
<li>客户端连接服务器，服务器发送自己的 <strong>公钥</strong>（比如通过证书）  </li>
<li>客户端生成一个随机的 <strong>对称密钥</strong>（如 AES 密钥）  </li>
<li>客户端用服务器的 <strong>公钥</strong> 加密这个对称密钥 → 发送给服务器  </li>
<li>服务器用自己的 <strong>私钥</strong> 解密 → 得到对称密钥  </li>
<li>之后所有通信，都用这个对称密钥加密&#x2F;解密！</li>
</ol>
<h4 id="3-风险在哪里？-3"><a href="#3-风险在哪里？-3" class="headerlink" title="3. 风险在哪里？"></a>3. 风险在哪里？</h4><p><strong>如果公钥是假的，对称密钥就会被黑客截获！</strong> 还是中间人攻击：</p>
<ol>
<li>黑客伪造服务器，把自己的公钥发给客户端  </li>
<li>客户端生成对称密钥，用“假公钥”加密 → 黑客用自己的私钥解密 → 得到真实对称密钥  </li>
<li>黑客再用真服务器的公钥加密对称密钥发给服务器  </li>
<li>之后所有通信，黑客都能用对称密钥解密！</li>
</ol>
<p><strong>问题根源：客户端无法确认收到的公钥是不是真的属于目标服务器！</strong></p>
<h4 id="4-优缺点"><a href="#4-优缺点" class="headerlink" title="4. 优缺点"></a>4. 优缺点</h4><ol>
<li><p>优点：</p>
<ul>
<li><p>对称加密快，适合大数据  </p>
</li>
<li><p>非对称只用于传密钥，计算量小</p>
</li>
</ul>
</li>
<li><p>缺点：</p>
<ul>
<li>公钥真实性无法保证 → 需要“身份认证”</li>
</ul>
</li>
</ol>
<blockquote>
<p>就像我们用防弹车（非对称加密）把保险箱钥匙（对称密钥）送到朋友家，但送错了地址（假服务器），钥匙被坏人拿到，之后我们寄的所有东西他都能打开！</p>
</blockquote>
<h3 id="方案-5（最终方案）非对称加密-对称加密-数字证书（HTTPS-真实方案）"><a href="#方案-5（最终方案）非对称加密-对称加密-数字证书（HTTPS-真实方案）" class="headerlink" title="方案 5（最终方案）非对称加密 + 对称加密 + 数字证书（HTTPS 真实方案）"></a>方案 5（最终方案）非对称加密 + 对称加密 + 数字证书（HTTPS 真实方案）</h3><h4 id="1-场景-4"><a href="#1-场景-4" class="headerlink" title="1. 场景"></a>1. 场景</h4><p>在方案 4 基础上，加入 <strong>数字证书</strong> 来验证服务器公钥的真实性！</p>
<h4 id="2-密钥如何传输？-4"><a href="#2-密钥如何传输？-4" class="headerlink" title="2. 密钥如何传输？"></a>2. 密钥如何传输？</h4><ol>
<li><strong>客户端发起 HTTPS 请求</strong> → 服务器返回 <strong>数字证书</strong>（包含服务器公钥 + 服务器身份信息 + <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E8%AF%81%E4%B9%A6%E9%A2%81%E5%8F%91%E6%9C%BA%E6%9E%84">CA</a> 签名）  </li>
<li><strong>客户端验证证书</strong>：<ul>
<li>用操作系统&#x2F;浏览器内置的 <strong>CA 公钥</strong> 验证证书签名是否合法  </li>
<li>检查证书是否过期、域名是否匹配等 → 如果验证失败，浏览器弹出警告</li>
</ul>
</li>
<li><strong>客户端生成随机对称密钥</strong>（如 AES-256）  </li>
<li><strong>客户端用证书里的服务器公钥加密对称密钥</strong> → 发送给服务器  </li>
<li><strong>服务器用自己的私钥解密</strong> → 得到对称密钥  </li>
<li><strong>之后所有通信都用对称密钥加密</strong>（高效、安全）</li>
</ol>
<h4 id="3-如何防御中间人攻击？"><a href="#3-如何防御中间人攻击？" class="headerlink" title="3. 如何防御中间人攻击？"></a>3. 如何防御中间人攻击？</h4><p><strong>数字证书由可信第三方（CA）签名</strong>，黑客无法伪造合法证书！黑客即使拦截通信，也无法伪造一个被 CA 签名的证书（除非攻破 CA，极难），客户端会校验证书，发现域名不符或签名无效 → 直接终止连接！</p>
<h4 id="4-补充安全机制（了解）"><a href="#4-补充安全机制（了解）" class="headerlink" title="4. 补充安全机制（了解）"></a>4. 补充安全机制（了解）</h4><ul>
<li><strong>前向保密（PFS）</strong>：每次会话生成临时密钥，即使服务器私钥未来泄露，历史会话也无法解密。（通过 ECDHE 等密钥交换算法实现）  </li>
<li><strong>证书吊销机制（CRL&#x2F;OCSP）</strong>：应对私钥泄露或证书被盗用。</li>
</ul>
<hr>
<h3 id="5-小结"><a href="#5-小结" class="headerlink" title="5. 小结"></a>5. 小结</h3><table>
<thead>
<tr>
<th>方案</th>
<th>加密方式</th>
<th>密钥传输方式</th>
<th>主要风险</th>
<th>是否可行</th>
</tr>
</thead>
<tbody><tr>
<td>方案 1</td>
<td>对称加密</td>
<td>明文传输或预共享</td>
<td>密钥被截获 → 全部暴露</td>
<td>❌ 不可行</td>
</tr>
<tr>
<td>方案 2</td>
<td>非对称加密</td>
<td>公钥公开传输</td>
<td>性能差 + 无法双向加密</td>
<td>❌ 不实用</td>
</tr>
<tr>
<td>方案 3</td>
<td>双方非对称</td>
<td>交换公钥</td>
<td>中间人攻击（公钥被替换&#x2F;掉包）</td>
<td>❌ 不安全</td>
</tr>
<tr>
<td>方案 4</td>
<td>非对称+对称（混合加密）</td>
<td>用公钥加密对称密钥</td>
<td>中间人攻击（公钥未认证，MITM 截获）</td>
<td>⚠️ 有漏洞</td>
</tr>
<tr>
<td>最终方案</td>
<td>混合 + 证书</td>
<td>用认证公钥加密对称密钥</td>
<td>依赖 CA 体系保障（极少数被攻破案例）</td>
<td>✅ 安全高效</td>
</tr>
</tbody></table>
<blockquote>
<p>之前看到的一个很形象、易理解的比喻：想象你要和朋友安全通信：</p>
<ul>
<li><strong>方案 1</strong>：你俩约好用同一把钥匙，但你得先寄给他 → 快递员偷了钥匙 → 完蛋。  </li>
<li><strong>方案 2</strong>：每次说话都用特制密码机，太慢 → 聊两句就卡死。  </li>
<li><strong>方案 3</strong>：你俩交换密码机的“公开使用说明”，但快递员把自己的说明书冒充你朋友的 → 你按他的说明书操作，他在偷听。  </li>
<li><strong>方案 4</strong>：你寄一把普通钥匙，但用朋友的“防伪密码箱”寄 → 但如果“防伪密码箱”是假的（快递员给的），钥匙还是被偷。  </li>
<li><strong>最终方案</strong>：朋友的“防伪密码箱”上有 <strong>公安局盖章认证</strong>（CA 证书）→ 你一看盖章是真的，才放心寄钥匙 → 安全！</li>
</ul>
</blockquote>
<h4 id="1-为什么-HTTPS-最终选择这个方案？"><a href="#1-为什么-HTTPS-最终选择这个方案？" class="headerlink" title="1. 为什么 HTTPS 最终选择这个方案？"></a>1. 为什么 HTTPS 最终选择这个方案？</h4><ol>
<li><strong>效率高</strong>：对称加密处理海量数据。</li>
<li><strong>安全强</strong>：非对称加密保护密钥传输。</li>
<li><strong>身份可信</strong>：CA 证书防止公钥被伪造。</li>
<li><strong>可扩展</strong>：支持前向保密、吊销、多域名等。</li>
</ol>
<h4 id="2-附加：密钥被攻击的几种真实场景"><a href="#2-附加：密钥被攻击的几种真实场景" class="headerlink" title="2. 附加：密钥被攻击的几种真实场景"></a>2. 附加：密钥被攻击的几种真实场景</h4><ol>
<li><strong>私钥泄露</strong>（服务器被入侵）→ 攻击者可解密历史通信（除非启用前向保密）。</li>
<li><strong>CA 被攻破</strong> → 攻击者可签发任意假证书（极罕见，如 DigiNotar 事件）。</li>
<li><strong>用户忽略证书警告</strong> → 主动接受假证书 → 中间人攻击成功。</li>
<li><strong>弱随机数生成器</strong> → 生成的对称密钥可预测 → 被破解。</li>
</ol>
<h3 id="6-理解链-承上启下"><a href="#6-理解链-承上启下" class="headerlink" title="6. 理解链 - 承上启下"></a>6. 理解链 - 承上启下</h3><h4 id="1-对-HTTP-进行对称加密，是否能解决数据通信安全的问题？问题是什么？"><a href="#1-对-HTTP-进行对称加密，是否能解决数据通信安全的问题？问题是什么？" class="headerlink" title="1. 对 HTTP 进行对称加密，是否能解决数据通信安全的问题？问题是什么？"></a>1. 对 HTTP 进行对称加密，是否能解决数据通信安全的问题？问题是什么？</h4><p><strong>不能完全解决，核心问题：密钥的分发。</strong></p>
<p>假设客户端和服务器都用同一个对称密钥来加密通信，这确实能防止第三方窃听。但是，这个密钥是如何从服务器安全地传递给客户端的呢？如果在连接建立之初，服务器直接把密钥明文发给客户端，那么中间人（黑客）同样可以截获这个密钥。一旦密钥泄露，后续所有的“加密”通信对中间人来说就等于没有加密。这就陷入了“<strong>先有鸡还是先有蛋</strong>”的困境：为了安全传输密钥，我们需要一个密钥来加密它，但这个“用来加密密钥的密钥”又该如何安全传输呢？</p>
<h4 id="2-为何要用非对称加密？"><a href="#2-为何要用非对称加密？" class="headerlink" title="2. 为何要用非对称加密？"></a>2. 为何要用非对称加密？</h4><p><strong>为了解决“密钥分发”问题</strong>。</p>
<p>非对称加密的特性（公钥加密，私钥解密）完美地解决了这个问题。服务器可以将自己的 <strong>公钥</strong> 通过明文的方式发送给客户端。客户端用这个公钥加密一个 <strong>对称密钥</strong> 后发送给服务器。即使中间人截获了这个加密后的对称密钥，他也无法解密，因为他没有服务器的 <strong>私钥</strong>。只有服务器能用自己的私钥解密，从而安全地获得对称密钥。</p>
<h4 id="3-为何不全用非对称加密？"><a href="#3-为何不全用非对称加密？" class="headerlink" title="3. 为何不全用非对称加密？"></a>3. 为何不全用非对称加密？</h4><p><strong>主要原因是性能</strong>。</p>
<p>非对称加密的算法非常复杂，其 <strong>加密和解密的速度远远慢于对称加密</strong>。如果整个 HTTPS 通信过程都使用非对称加密，会极大地消耗服务器和客户端的计算资源，导致网页加载速度变慢，用户体验很差。<strong>因此，最佳实践是结合两者</strong>：使用非对称加密来安全地 <strong>协商</strong> 一个临时的对称密钥，然后在后续的大量数据传输中，使用这个对称密钥进行高效加密。这就是 HTTPS 的核心工作原理。</p>
<h4 id="4-CA-签名认证-VS-数字证书-VS-数字签名"><a href="#4-CA-签名认证-VS-数字证书-VS-数字签名" class="headerlink" title="4. CA 签名认证 VS 数字证书 VS 数字签名"></a>4. CA 签名认证 VS 数字证书 VS 数字签名</h4><p><strong>数字签名、数字证书、CA 签名认证</strong> 这三样东西经常被混在一起说，但它们 <strong>不是一个东西</strong>，而是三个环环相扣的概念：<strong><code>CA 签名认证  →  产生合法的数字证书  →  证书里面包含数字签名</code>。</strong></p>
<ol>
<li><p><strong>数字签名：</strong> 就是“用私钥对一段数据做的签名”，任何人都能用对应的公钥验证签名是否有效。<strong>用途：</strong> 保证数据没有被篡改（完整性）、保证数据确实是“私钥持有者”发的（身份认证）。<strong>简单例子：</strong></p>
<ul>
<li>服务器把自己的公钥信息、域名信息打个包 → 用私钥生成一个签名。</li>
<li>客户端用服务器的公钥验证签名，能验证这份数据确实出自服务器本人。</li>
<li>类比：数字签名 &#x3D; 手写签名&#x2F;盖章。别人可以看到签名，验证是你签的，但没法伪造。</li>
</ul>
</li>
<li><p><strong>数字证书：</strong> 一份“带身份证明的公钥”，里面包含：服务器的公钥、服务器的域名信息（比如 <code>www.google.com</code>）、有效期、用途等信息、还有一个 <strong>数字签名</strong>（由 CA 生成的）。</p>
<ul>
<li><strong>用途：</strong> 客户端拿到证书后，不仅知道“这是公钥”，还知道“这个公钥是属于哪个网站的”，解决了“公钥是谁的”这个问题。</li>
<li><strong>类比：</strong> 数字证书 &#x3D; 身份证。身份证上写着你的名字（域名）、照片（公钥），还有公安局的盖章（CA 签名）。</li>
</ul>
</li>
<li><p><strong>CA 签名认证：</strong> 就是证书里的“盖章”部分 —— 证书不是服务器自己随便说“这是我的身份证”，而是交给权威机构（CA，证书颁发机构）去验证，然后 <strong>CA 用自己的私钥签名</strong>，证明这份证书是真的。</p>
<ul>
<li><p><strong>流程：</strong></p>
<ol>
<li>服务器 → 提交公钥 + 域名信息给 CA。</li>
<li>CA 审核（域名验证、公司验证等）。</li>
<li>CA 用自己的 <strong>私钥</strong> 对证书做数字签名。</li>
<li>浏览器内置了各大 CA 的 <strong>公钥</strong> → 可以验证证书签名是否有效。</li>
</ol>
</li>
<li><p><strong>用途：</strong> 确保证书是真的，不是黑客自己伪造的，确认公钥确实属于 <code>www.xxx.com</code>。</p>
</li>
</ul>
<blockquote>
<p>  类比：CA 签名认证 &#x3D; 公安局给身份证盖章。别人一看章是真的，就知道身份证不是假造的。</p>
</blockquote>
</li>
</ol>
<h2 id="3-关于-HTTPS-的一些扩展和思考"><a href="#3-关于-HTTPS-的一些扩展和思考" class="headerlink" title="3. 关于 HTTPS 的一些扩展和思考"></a>3. 关于 HTTPS 的一些扩展和思考</h2><h3 id="1-CA-签名流程是不是先做摘要？"><a href="#1-CA-签名流程是不是先做摘要？" class="headerlink" title="1. CA 签名流程是不是先做摘要？"></a>1. CA 签名流程是不是先做摘要？</h3><p><strong>是的。</strong> CA 在给证书签名时，先对证书内容（域名、公钥、有效期等）做 <strong>Hash 得到摘要</strong>，再用 <strong>CA 私钥加密摘要</strong> → 得到 <strong>数字签名</strong> → 把签名 + 原始证书信息一起 <strong>发送</strong> 给客户端。<strong>证书 &#x3D; 明文信息 + 签名，签名 &#x3D; 用私钥加密“数据的摘要”</strong>。浏览器验证时：先用相同算法对证书内容 hash，再用 CA 公钥解密签名得到摘要，两者对比 → 确认证书没被篡改。</p>
<h3 id="2-为什么数字签名（如-CA-对证书签名）不直接用私钥加密原始数据（如证书或任意文件），而要先对数据做-Hash-生成摘要，再对摘要进行加密签名？"><a href="#2-为什么数字签名（如-CA-对证书签名）不直接用私钥加密原始数据（如证书或任意文件），而要先对数据做-Hash-生成摘要，再对摘要进行加密签名？" class="headerlink" title="2. 为什么数字签名（如 CA 对证书签名）不直接用私钥加密原始数据（如证书或任意文件），而要先对数据做 Hash 生成摘要，再对摘要进行加密签名？"></a>2. 为什么数字签名（如 CA 对证书签名）不直接用私钥加密原始数据（如证书或任意文件），而要先对数据做 Hash 生成摘要，再对摘要进行加密签名？</h3><p>因为直接用私钥加密原始数据 <strong>效率极低</strong> —— 非对称加密计算慢，且受数据长度限制，不适合大文件或频繁操作；而先对数据做 Hash 生成固定长度的“摘要”，再加密摘要，既大幅 <strong>提升签名速度</strong>，又 <strong>保证了安全性</strong>。更重要的是，Hash 摘要具备“雪崩效应”和抗篡改性：哪怕原文改动一个字节，摘要也会彻底改变，接收方通过比对摘要即可验证完整性。同时，先 Hash 还能 <strong>防御</strong>“长度扩展攻击”等密码学漏洞，确保签名机制在各种场景下（如证书、文件、消息）都安全、高效、标准化。</p>
<p><strong>所以标准流程：原文 → Hash(摘要) → 用私钥加密(签名)。客户端验证时：收到原文 &amp; 签名 → 原文重新 Hash → 用公钥解密签名 &#x3D; 摘要 → 两个摘要比对一致 → 证明原文没改、签名有效。</strong></p>
<h3 id="3-如何成为中间人（MITM）"><a href="#3-如何成为中间人（MITM）" class="headerlink" title="3. 如何成为中间人（MITM）"></a>3. 如何成为中间人（MITM）</h3><h4 id="1-ARP-欺骗"><a href="#1-ARP-欺骗" class="headerlink" title="1. ARP 欺骗"></a>1. ARP 欺骗</h4><p>局域网里，电脑通信需要知道对方的 MAC 地址。ARP（地址解析协议）就是负责“IP ↔ MAC 地址绑定”。<strong>漏洞</strong>：ARP 没有验证机制，谁说自己是某个 IP 就信。<strong>攻击方法</strong>：黑客冒充别人：</p>
<ul>
<li>主机 A 想访问主机 B → 先广播“B 的 MAC 地址谁知道？”</li>
<li>黑客抢答：“我是 B，我的 MAC 是 xxx”</li>
<li>结果 A 把流量都发给黑客，黑客再转发给 B → 黑客变中间人。</li>
</ul>
<p>就像在班里传纸条，A 想传给 B，黑客插话说“我就是 B，把纸条给我” → 再偷偷看一眼转交给真 B。</p>
<h4 id="2-ICMP-重定向攻击"><a href="#2-ICMP-重定向攻击" class="headerlink" title="2. ICMP 重定向攻击"></a>2. ICMP 重定向攻击</h4><p>ICMP 协议里有一种“重定向消息”，路由器可以告诉主机：“嘿，这个目标地址，你应该走另一条更好的路”。<strong>漏洞</strong>：ICMP 没验证，谁都能发。<strong>攻击方法</strong>：</p>
<ul>
<li>黑客伪造 ICMP 消息，告诉受害者“要访问外网，请经过我这台路由器”。</li>
<li>结果受害者的所有流量都经过黑客机器。</li>
</ul>
<p>就像问路，路人甲（黑客）冒充警察说“你要去市中心？从我家后门穿过去更快” → 结果你绕进了陷阱。</p>
<h4 id="3-假-WiFi-假网站"><a href="#3-假-WiFi-假网站" class="headerlink" title="3. 假 WiFi &#x2F; 假网站"></a>3. 假 WiFi &#x2F; 假网站</h4><ul>
<li><strong>假 WiFi（所谓的钓鱼网络）</strong>：黑客开个和真 WiFi 同名的热点，用户连上去后，所有流量都经过黑客电脑 → 可以监控&#x2F;篡改数据。</li>
<li><strong>假网站</strong>：黑客在局域网或 DNS 劫持，把 <code>www.google.com</code> 映射到自己控制的假服务器 → 用户以为在访问银行，其实是黑客的钓鱼网站。</li>
</ul>
<p>就像黑客开了一家“假银行”，外观和真的一样，但柜员全是演员，用户输入账号密码就等于都交给了他。<strong>本质：中间人就是把流量骗到自己手里，再决定是“只偷听”还是“修改后转发”。</strong></p>
<h4 id="4-HTTPS-中间人（需用户配合或证书漏洞）"><a href="#4-HTTPS-中间人（需用户配合或证书漏洞）" class="headerlink" title="4. HTTPS 中间人（需用户配合或证书漏洞）"></a>4. HTTPS 中间人（需用户配合或证书漏洞）</h4><p><strong>原理：伪造 SSL 证书，骗浏览器信任。</strong> 操作：黑客作为中间人，拦截 HTTPS 请求 伪造一个“假证书”发给客户端（如自签名或盗用 CA），如果用户点击“继续访问（不安全）”，则攻击成功，防御：浏览器会警告“证书不受信任”，我们用户不点“忽略”就攻不破。</p>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://github.com/huangcancan-xbc/Drawing-bed/blob/master/Blog/20250307201719879.png?raw=true" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://github.com/huangcancan-xbc/Drawing-bed/blob/master/Blog/20250307201719879.png?raw=true" title="头像" alt="头像"></a><div class="post-copyright__author_name">小米里的大麦</div><div class="post-copyright__author_desc"></div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://www.minbit.top/posts/34998.html">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('https://www.minbit.top/posts/34998.html')">049 HTTPS 协议原理</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250403212543768.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250403212543768.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250403212622868.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250403212622868.png" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://www.minbit.top/posts/34998.html"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=049 HTTPS 协议原理&amp;url=https://www.minbit.top/posts/34998.html&amp;pic=https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250314131841400.png?_r_=d20d13f8-c4a1-3018-7b57-dfc505aaf25a" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">MIT</a> 许可协议。转载请注明来自 <a href="https://www.minbit.top" target="_blank">小米里的大麦</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/Linux/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Linux<span class="tagsPageCount">50</span></a><a class="post-meta__box__tags" href="/tags/%E7%BD%91%E7%BB%9C/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>网络<span class="tagsPageCount">6</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250314125923408.png?_r_=589997d1-2591-0775-e5e3-4f301a7db57f" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/63840.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250817000335747.png?_r_=d7eeeb88-b375-c1d2-71d2-9fa4ce942e93" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">048 HTTP 协议</div></div></a></div><div class="next-post pull-right"><a href="/posts/62772.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250314125923408.png?_r_=589997d1-2591-0775-e5e3-4f301a7db57f" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">050 传输层 —— UDP</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/posts/38905.html" title="047 网络传输基础：TCP 连接建立与数据序列化"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250817000335747.png?_r_=6a0bf21f-d544-710a-2354-ef7b6e11acfb" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-08-22</div><div class="title">047 网络传输基础：TCP 连接建立与数据序列化</div></div></a></div><div><a href="/posts/47537.html" title="045 网络基础"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250817000335747.png?_r_=95a3b92b-7619-0365-f5bc-3e1d0f94cfc8" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-08-12</div><div class="title">045 网络基础</div></div></a></div><div><a href="/posts/40348.html" title="046 网络编程套接字"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250314131841400.png?_r_=235af0ea-4273-916a-faeb-502ab2004876" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-08-15</div><div class="title">046 网络编程套接字</div></div></a></div><div><a href="/posts/63840.html" title="048 HTTP 协议"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250817000335747.png?_r_=d7eeeb88-b375-c1d2-71d2-9fa4ce942e93" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-08-25</div><div class="title">048 HTTP 协议</div></div></a></div><div><a href="/posts/62772.html" title="050 传输层 —— UDP"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250314125923408.png?_r_=589997d1-2591-0775-e5e3-4f301a7db57f" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-09-12</div><div class="title">050 传输层 —— UDP</div></div></a></div><div><a href="/posts/55415.html" title="002 创建普通账户（为朋友创建、删除账户）"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250817000335747.png?_r_=1afc30bf-9522-d21e-c511-fb0d5268d01d" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-02-17</div><div class="title">002 创建普通账户（为朋友创建、删除账户）</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div><div class="comment-tips" id="comment-tips"><span>✅ 你无需删除空行，直接评论以获取最佳展示效果</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://github.com/huangcancan-xbc/Drawing-bed/blob/master/Blog/20250307201719879.png?raw=true" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/08/24/64e6ce9c507bb.png" alt="status"/></div></div><div class="author-info__description">时间好像总会留下点什么,或许是一个人,或许是一个梦,或许……是一段有意义的经历~</div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">小米里的大麦</h1><div class="author-info__desc"></div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/huangcancan-xbc" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a></div></div></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bullhorn anzhiyu-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来看我的博客鸭~<br>建议优先查看置顶的 <a href="https://www.minbit.top/posts/17934.html">网站说明</a> 哦~</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#HTTPS-%E5%8D%8F%E8%AE%AE%E5%8E%9F%E7%90%86"><span class="toc-number">1.</span> <span class="toc-text">HTTPS 协议原理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%A6%82%E5%BF%B5%E5%87%86%E5%A4%87"><span class="toc-number">1.1.</span> <span class="toc-text">1. 概念准备</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-HTTPS-%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">1.1.1.</span> <span class="toc-text">1. HTTPS 是什么？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BB%80%E4%B9%88%E6%98%AF%E5%8A%A0%E5%AF%86%EF%BC%9F"><span class="toc-number">1.1.2.</span> <span class="toc-text">2. 什么是加密？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%8A%A0%E5%AF%86%EF%BC%9F"><span class="toc-number">1.1.3.</span> <span class="toc-text">3. 为什么要加密？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%B8%B8%E8%A7%81%E7%9A%84%E5%8A%A0%E5%AF%86%E6%96%B9%E5%BC%8F"><span class="toc-number">1.1.4.</span> <span class="toc-text">4. 常见的加密方式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86"><span class="toc-number">1.1.4.1.</span> <span class="toc-text">1. 对称加密</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86"><span class="toc-number">1.1.4.2.</span> <span class="toc-text">2. 非对称加密</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%95%B0%E6%8D%AE%E6%91%98%E8%A6%81-%E6%95%B0%E6%8D%AE%E6%8C%87%E7%BA%B9"><span class="toc-number">1.1.4.3.</span> <span class="toc-text">3. 数据摘要 &amp;&amp; 数据指纹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D%EF%BC%88%E5%90%8E%E9%9D%A2%E7%BB%86%E8%AF%B4%EF%BC%89"><span class="toc-number">1.1.4.4.</span> <span class="toc-text">4. 数字签名（后面细说）</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-HTTPS-%E7%9A%84-5-%E7%A7%8D%E6%96%B9%E6%A1%88%E6%8E%A2%E7%A9%B6"><span class="toc-number">1.2.</span> <span class="toc-text">2. HTTPS 的 5 种方案探究</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%A1%88-1%EF%BC%9A%E5%8F%AA%E4%BD%BF%E7%94%A8%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86"><span class="toc-number">1.2.1.</span> <span class="toc-text">方案 1：只使用对称加密</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%9C%BA%E6%99%AF"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">1. 场景</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%AF%86%E9%92%A5%E5%A6%82%E4%BD%95%E4%BC%A0%E8%BE%93%EF%BC%9F"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">2. 密钥如何传输？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E9%A3%8E%E9%99%A9%E5%9C%A8%E5%93%AA%E9%87%8C%EF%BC%9F"><span class="toc-number">1.2.1.3.</span> <span class="toc-text">3. 风险在哪里？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E4%BA%A7%E7%94%9F%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">1.2.1.4.</span> <span class="toc-text">4. 产生的问题</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%A1%88-2%EF%BC%9A%E5%8F%AA%E4%BD%BF%E7%94%A8%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86"><span class="toc-number">1.2.2.</span> <span class="toc-text">方案 2：只使用非对称加密</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%9C%BA%E6%99%AF-1"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">1. 场景</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%AF%86%E9%92%A5%E5%A6%82%E4%BD%95%E4%BC%A0%E8%BE%93%EF%BC%9F-1"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">2. 密钥如何传输？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E9%A3%8E%E9%99%A9%E5%9C%A8%E5%93%AA%E9%87%8C%EF%BC%9F-1"><span class="toc-number">1.2.2.3.</span> <span class="toc-text">3. 风险在哪里？</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%A1%88-3%EF%BC%9A%E5%8F%8C%E6%96%B9%E9%83%BD%E4%BD%BF%E7%94%A8%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86"><span class="toc-number">1.2.3.</span> <span class="toc-text">方案 3：双方都使用非对称加密</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%9C%BA%E6%99%AF-2"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">1. 场景</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%AF%86%E9%92%A5%E5%A6%82%E4%BD%95%E4%BC%A0%E8%BE%93%EF%BC%9F-2"><span class="toc-number">1.2.3.2.</span> <span class="toc-text">2. 密钥如何传输？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E9%A3%8E%E9%99%A9%E5%9C%A8%E5%93%AA%E9%87%8C%EF%BC%9F-2"><span class="toc-number">1.2.3.3.</span> <span class="toc-text">3. 风险在哪里？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E4%BA%A7%E7%94%9F%E7%9A%84%E9%97%AE%E9%A2%98-1"><span class="toc-number">1.2.3.4.</span> <span class="toc-text">4. 产生的问题</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%A1%88-4%EF%BC%9A%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86-%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%EF%BC%88%E6%B7%B7%E5%90%88%E6%96%B9%E6%A1%88%EF%BC%89"><span class="toc-number">1.2.4.</span> <span class="toc-text">方案 4：非对称加密 + 对称加密（混合方案）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%9C%BA%E6%99%AF-3"><span class="toc-number">1.2.4.1.</span> <span class="toc-text">1. 场景</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%AF%86%E9%92%A5%E5%A6%82%E4%BD%95%E4%BC%A0%E8%BE%93%EF%BC%9F-3"><span class="toc-number">1.2.4.2.</span> <span class="toc-text">2. 密钥如何传输？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E9%A3%8E%E9%99%A9%E5%9C%A8%E5%93%AA%E9%87%8C%EF%BC%9F-3"><span class="toc-number">1.2.4.3.</span> <span class="toc-text">3. 风险在哪里？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="toc-number">1.2.4.4.</span> <span class="toc-text">4. 优缺点</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%A1%88-5%EF%BC%88%E6%9C%80%E7%BB%88%E6%96%B9%E6%A1%88%EF%BC%89%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86-%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6%EF%BC%88HTTPS-%E7%9C%9F%E5%AE%9E%E6%96%B9%E6%A1%88%EF%BC%89"><span class="toc-number">1.2.5.</span> <span class="toc-text">方案 5（最终方案）非对称加密 + 对称加密 + 数字证书（HTTPS 真实方案）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%9C%BA%E6%99%AF-4"><span class="toc-number">1.2.5.1.</span> <span class="toc-text">1. 场景</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%AF%86%E9%92%A5%E5%A6%82%E4%BD%95%E4%BC%A0%E8%BE%93%EF%BC%9F-4"><span class="toc-number">1.2.5.2.</span> <span class="toc-text">2. 密钥如何传输？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%A6%82%E4%BD%95%E9%98%B2%E5%BE%A1%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB%EF%BC%9F"><span class="toc-number">1.2.5.3.</span> <span class="toc-text">3. 如何防御中间人攻击？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E8%A1%A5%E5%85%85%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%EF%BC%88%E4%BA%86%E8%A7%A3%EF%BC%89"><span class="toc-number">1.2.5.4.</span> <span class="toc-text">4. 补充安全机制（了解）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%B0%8F%E7%BB%93"><span class="toc-number">1.2.6.</span> <span class="toc-text">5. 小结</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E4%B8%BA%E4%BB%80%E4%B9%88-HTTPS-%E6%9C%80%E7%BB%88%E9%80%89%E6%8B%A9%E8%BF%99%E4%B8%AA%E6%96%B9%E6%A1%88%EF%BC%9F"><span class="toc-number">1.2.6.1.</span> <span class="toc-text">1. 为什么 HTTPS 最终选择这个方案？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E9%99%84%E5%8A%A0%EF%BC%9A%E5%AF%86%E9%92%A5%E8%A2%AB%E6%94%BB%E5%87%BB%E7%9A%84%E5%87%A0%E7%A7%8D%E7%9C%9F%E5%AE%9E%E5%9C%BA%E6%99%AF"><span class="toc-number">1.2.6.2.</span> <span class="toc-text">2. 附加：密钥被攻击的几种真实场景</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E7%90%86%E8%A7%A3%E9%93%BE-%E6%89%BF%E4%B8%8A%E5%90%AF%E4%B8%8B"><span class="toc-number">1.2.7.</span> <span class="toc-text">6. 理解链 - 承上启下</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%AF%B9-HTTP-%E8%BF%9B%E8%A1%8C%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%EF%BC%8C%E6%98%AF%E5%90%A6%E8%83%BD%E8%A7%A3%E5%86%B3%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1%E5%AE%89%E5%85%A8%E7%9A%84%E9%97%AE%E9%A2%98%EF%BC%9F%E9%97%AE%E9%A2%98%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">1.2.7.1.</span> <span class="toc-text">1. 对 HTTP 进行对称加密，是否能解决数据通信安全的问题？问题是什么？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E4%B8%BA%E4%BD%95%E8%A6%81%E7%94%A8%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%EF%BC%9F"><span class="toc-number">1.2.7.2.</span> <span class="toc-text">2. 为何要用非对称加密？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E4%B8%BA%E4%BD%95%E4%B8%8D%E5%85%A8%E7%94%A8%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%EF%BC%9F"><span class="toc-number">1.2.7.3.</span> <span class="toc-text">3. 为何不全用非对称加密？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-CA-%E7%AD%BE%E5%90%8D%E8%AE%A4%E8%AF%81-VS-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6-VS-%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D"><span class="toc-number">1.2.7.4.</span> <span class="toc-text">4. CA 签名认证 VS 数字证书 VS 数字签名</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%85%B3%E4%BA%8E-HTTPS-%E7%9A%84%E4%B8%80%E4%BA%9B%E6%89%A9%E5%B1%95%E5%92%8C%E6%80%9D%E8%80%83"><span class="toc-number">1.3.</span> <span class="toc-text">3. 关于 HTTPS 的一些扩展和思考</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-CA-%E7%AD%BE%E5%90%8D%E6%B5%81%E7%A8%8B%E6%98%AF%E4%B8%8D%E6%98%AF%E5%85%88%E5%81%9A%E6%91%98%E8%A6%81%EF%BC%9F"><span class="toc-number">1.3.1.</span> <span class="toc-text">1. CA 签名流程是不是先做摘要？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%B8%BA%E4%BB%80%E4%B9%88%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D%EF%BC%88%E5%A6%82-CA-%E5%AF%B9%E8%AF%81%E4%B9%A6%E7%AD%BE%E5%90%8D%EF%BC%89%E4%B8%8D%E7%9B%B4%E6%8E%A5%E7%94%A8%E7%A7%81%E9%92%A5%E5%8A%A0%E5%AF%86%E5%8E%9F%E5%A7%8B%E6%95%B0%E6%8D%AE%EF%BC%88%E5%A6%82%E8%AF%81%E4%B9%A6%E6%88%96%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%EF%BC%89%EF%BC%8C%E8%80%8C%E8%A6%81%E5%85%88%E5%AF%B9%E6%95%B0%E6%8D%AE%E5%81%9A-Hash-%E7%94%9F%E6%88%90%E6%91%98%E8%A6%81%EF%BC%8C%E5%86%8D%E5%AF%B9%E6%91%98%E8%A6%81%E8%BF%9B%E8%A1%8C%E5%8A%A0%E5%AF%86%E7%AD%BE%E5%90%8D%EF%BC%9F"><span class="toc-number">1.3.2.</span> <span class="toc-text">2. 为什么数字签名（如 CA 对证书签名）不直接用私钥加密原始数据（如证书或任意文件），而要先对数据做 Hash 生成摘要，再对摘要进行加密签名？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%A6%82%E4%BD%95%E6%88%90%E4%B8%BA%E4%B8%AD%E9%97%B4%E4%BA%BA%EF%BC%88MITM%EF%BC%89"><span class="toc-number">1.3.3.</span> <span class="toc-text">3. 如何成为中间人（MITM）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-ARP-%E6%AC%BA%E9%AA%97"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">1. ARP 欺骗</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-ICMP-%E9%87%8D%E5%AE%9A%E5%90%91%E6%94%BB%E5%87%BB"><span class="toc-number">1.3.3.2.</span> <span class="toc-text">2. ICMP 重定向攻击</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%81%87-WiFi-%E5%81%87%E7%BD%91%E7%AB%99"><span class="toc-number">1.3.3.3.</span> <span class="toc-text">3. 假 WiFi &#x2F; 假网站</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-HTTPS-%E4%B8%AD%E9%97%B4%E4%BA%BA%EF%BC%88%E9%9C%80%E7%94%A8%E6%88%B7%E9%85%8D%E5%90%88%E6%88%96%E8%AF%81%E4%B9%A6%E6%BC%8F%E6%B4%9E%EF%BC%89"><span class="toc-number">1.3.3.4.</span> <span class="toc-text">4. HTTPS 中间人（需用户配合或证书漏洞）</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/62772.html" title="050 传输层 —— UDP"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250314125923408.png?_r_=589997d1-2591-0775-e5e3-4f301a7db57f" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="050 传输层 —— UDP"/></a><div class="content"><a class="title" href="/posts/62772.html" title="050 传输层 —— UDP">050 传输层 —— UDP</a><time datetime="2025-09-12T04:00:00.000Z" title="发表于 2025-09-12 12:00:00">2025-09-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/34998.html" title="049 HTTPS 协议原理"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250314131841400.png?_r_=d20d13f8-c4a1-3018-7b57-dfc505aaf25a" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="049 HTTPS 协议原理"/></a><div class="content"><a class="title" href="/posts/34998.html" title="049 HTTPS 协议原理">049 HTTPS 协议原理</a><time datetime="2025-08-28T04:00:00.000Z" title="发表于 2025-08-28 12:00:00">2025-08-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/63840.html" title="048 HTTP 协议"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250817000335747.png?_r_=d7eeeb88-b375-c1d2-71d2-9fa4ce942e93" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="048 HTTP 协议"/></a><div class="content"><a class="title" href="/posts/63840.html" title="048 HTTP 协议">048 HTTP 协议</a><time datetime="2025-08-25T04:00:00.000Z" title="发表于 2025-08-25 12:00:00">2025-08-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/38905.html" title="047 网络传输基础：TCP 连接建立与数据序列化"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250817000335747.png?_r_=6a0bf21f-d544-710a-2354-ef7b6e11acfb" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="047 网络传输基础：TCP 连接建立与数据序列化"/></a><div class="content"><a class="title" href="/posts/38905.html" title="047 网络传输基础：TCP 连接建立与数据序列化">047 网络传输基础：TCP 连接建立与数据序列化</a><time datetime="2025-08-22T04:00:00.000Z" title="发表于 2025-08-22 12:00:00">2025-08-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/40348.html" title="046 网络编程套接字"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250314131841400.png?_r_=235af0ea-4273-916a-faeb-502ab2004876" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="046 网络编程套接字"/></a><div class="content"><a class="title" href="/posts/40348.html" title="046 网络编程套接字">046 网络编程套接字</a><time datetime="2025-08-15T04:00:00.000Z" title="发表于 2025-08-15 12:00:00">2025-08-15</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="footer_deal"><a class="deal_link" href="mailto:hc1960074081@qq.com" title="email"><i class="anzhiyufont anzhiyu-icon-envelope"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://weibo.com/u/7913790969" title="微博"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a><img class="footer_mini_logo" title="返回顶部" alt="返回顶部" onclick="anzhiyu.scrollToDest(0, 500)" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://github.com/huangcancan-xbc/Drawing-bed/blob/master/Blog/20250307201719879.png?raw=true" size="50px"/><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/huangcancan-xbc" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://space.bilibili.com/1918272544" title="Bilibili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a></div></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2025 By <a class="footer-bar-link" href="/" title="小米里的大麦" target="_blank">小米里的大麦</a></div></div><div id="footer-type-tips"></div><div class="js-pjax"><script>function subtitleType () {
  fetch('https://v1.hitokoto.cn')
    .then(response => response.json())
    .then(data => {
      if (true) {
        const from = '出自 ' + data.from
        const sub = ["《左传》载曰：“太上有立德，其次有立功，其次有立言，虽久不废，此之谓不朽。”","纸上得来终觉浅，绝知此事要躬行！","你太专注于未来，却没有意识到，今天正是你多年前祈求的模样，因为你眺望远方视而不见。","梦想是不会发光的，发光的是追梦的你！"]
        sub.unshift(data.hitokoto, from)
        window.typed = new Typed('#footer-type-tips', {
          strings: sub,
          startDelay: 300,
          typeSpeed: 150,
          loop: true,
          backSpeed: 50,
        })
      } else {
        document.getElementById('footer-type-tips').innerHTML = data.hitokoto
      }
    })
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.cbd.int/typed.js@2.1.0/dist/typed.umd.js').then(subtitleType)
  }
} else {
  subtitleType()
}
</script></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/huangcancan-xbc" title="GitHub主页">GitHub主页</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">64</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">19</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">6</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">社交</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://github.com/huangcancan-xbc" title="GitHub"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="GitHub"/><span class="back-menu-item-text">GitHub</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://space.bilibili.com/1918272544" title="哔哩哔哩"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="哔哩哔哩"/><span class="back-menu-item-text">哔哩哔哩</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://gitee.com/huang-cancan-xbc" title="Gitee"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="Gitee"/><span class="back-menu-item-text">Gitee</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">博客</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.csdn.net/Huangcancan666?type=blog" title="CSDN"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="CSDN"/><span class="back-menu-item-text">CSDN</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://juejin.cn/user/3230789931118109" title="稀土掘金"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="稀土掘金"/><span class="back-menu-item-text">稀土掘金</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/charts/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 统计</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 外链</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/C/" style="font-size: 0.88rem;">C++<sup>8</sup></a><a href="/tags/Git/" style="font-size: 0.88rem;">Git<sup>3</sup></a><a href="/tags/IO/" style="font-size: 0.88rem;">IO<sup>3</sup></a><a href="/tags/Linux/" style="font-size: 0.88rem;">Linux<sup>50</sup></a><a href="/tags/Obsidian/" style="font-size: 0.88rem;">Obsidian<sup>1</sup></a><a href="/tags/STL/" style="font-size: 0.88rem;">STL<sup>2</sup></a><a href="/tags/VS-Code/" style="font-size: 0.88rem;">VS Code<sup>1</sup></a><a href="/tags/%E4%BF%A1%E5%8F%B7/" style="font-size: 0.88rem;">信号<sup>3</sup></a><a href="/tags/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/" style="font-size: 0.88rem;">内存管理<sup>1</sup></a><a href="/tags/%E5%8E%86%E7%A8%8B/" style="font-size: 0.88rem;">历程<sup>1</sup></a><a href="/tags/%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4/" style="font-size: 0.88rem;">地址空间<sup>6</sup></a><a href="/tags/%E6%95%B0%E5%AD%A6/" style="font-size: 0.88rem;">数学<sup>1</sup></a><a href="/tags/%E6%A8%A1%E6%9D%BF/" style="font-size: 0.88rem;">模板<sup>1</sup></a><a href="/tags/%E7%AE%A1%E9%81%93/" style="font-size: 0.88rem;">管道<sup>2</sup></a><a href="/tags/%E7%B1%BB%E4%B8%8E%E5%AF%B9%E8%B1%A1/" style="font-size: 0.88rem;">类与对象<sup>3</sup></a><a href="/tags/%E7%BA%BF%E7%A8%8B/" style="font-size: 0.88rem;">线程<sup>4</sup></a><a href="/tags/%E7%BD%91%E7%AB%99/" style="font-size: 0.88rem;">网站<sup>2</sup></a><a href="/tags/%E7%BD%91%E7%BB%9C/" style="font-size: 0.88rem;">网络<sup>6</sup></a><a href="/tags/%E8%BF%9B%E7%A8%8B/" style="font-size: 0.88rem;">进程<sup>15</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><a id="switch-commentBarrage" href="javascript:anzhiyu.switchCommentBarrage();" title="开关弹幕"><i class="anzhiyufont anzhiyu-icon-danmu"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("01/01/2025 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2025 By 安知鱼 V1.6.14",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 小米里的大麦 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://twikoo-olive-one.vercel.app/',
      // 自己额外添加的：
      path: location.pathname.replace(/index\.html$/, ''),
      
      region: 'ap-shanghai',
      onCommentLoaded: () => {
        anzhiyu.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(runFn,0)
    else getScript('https://cdn.cbd.int/twikoo@1.6.44/dist/twikoo.all.min.js').then(runFn)
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo-olive-one.vercel.app/',
      region: 'ap-shanghai',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const runFn = () => {
    init();
    GLOBAL_CONFIG_SITE.isPost && getCount()
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) anzhiyu.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else {
      loadTwikoo()
    }
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"><script async src="/js/anzhiyu/comment_barrage.js"></script></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'https://twikoo-olive-one.vercel.app/',
        region: 'ap-shanghai',
        pageSize: 6,
        includeReply: true
      }).then(function (res) {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        saveToLocal.set('twikoo-newest-comments', JSON.stringify(twikooArray), 10/(60*24))
        generateHtml(twikooArray)
      }).catch(function (err) {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.textContent= "无法获取评论，请确认相关配置是否正确"
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      getScript('https://cdn.cbd.int/twikoo@1.6.44/dist/twikoo.all.min.js').then(runTwikoo)
    }
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'><div class='name'><span>${array[i].nick} </span></div></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom && ($dom.innerHTML= result)
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('twikoo-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.1/bubble/bubble.js"></script><script>var visitorMail = "xiaomilidedamai@minbit.top";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script src="/js/anzhiyu/right_click_menu.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><script src="https://cdn.bootcdn.net/ajax/libs/echarts/4.9.0-rc.1/echarts.min.js"></script><script src="/js/footer-animal.js" defer></script><script id="click-show-text" src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/click-show-text.min.js" data-mobile="false" data-text="offer,暴富,健康,offer,喜乐,成功,offer,好运,自由,offer,坚持,上岸" data-fontsize="20px" data-random="true" async="async"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","meta[property=\"og:type\"]","meta[property=\"og:site_name\"]","meta[property=\"og:description\"]","head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"]):not([href="/music/"]):not([href="/no-pjax/"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script><script>//- 留言板页面弹幕
window.addEventListener('load', () => {
  const getnaokuo_danmu = () => {
    if (!window.location.pathname.startsWith('/comments/')) return; //- 判断是否是留言板页面
    const naokuo_danmu = async () => {
      const Danmaku = new EasyDanmaku({
        page: '/comments/', //- 即留言板地址
        el: '#danmu-wrap', //- 弹幕挂载节点
        line: 5, //- 弹幕行数
        speed: 20, //- 弹幕播放速度
        hover: true, //- 鼠标hover时是否暂停播放弹幕
        loop: false, //- 开启循环播放
        colourful: true, //- 开启彩色弹幕
        coefficient: 1.38, //- 弹幕密度系数
        runtime: 10, //- 循环弹幕播放时长
      });
      try {
        let danmuStore = saveToLocal.get('twikoo-danmu');
        if (!danmuStore) {
          const options = {
            method: "POST",
            body: JSON.stringify({
              "event": "GET_RECENT_COMMENTS",
              "includeReply": false,
              "pageSize": 100
            }),
            headers: { 'Content-Type': 'application/json' }
          }
          danmuStore = [];
          const response = await fetch(`https://twikoo-olive-one.vercel.app/`, options);
          if (response.ok) {
            const { data } = await response.json();
            //- console.info(data);
            data.forEach(i => {
              if (i.avatar == undefined) i.avatar = 'https://cravatar.cn/avatar/d615d5793929e8c7d70eab5f00f7f5f1?d=mp'
              danmuStore.push({ avatar: i.avatar, content: i.nick + '：' + formatDanmaku(i.comment), url: i.url + '#' + i.id })
            });
            Danmaku.batchSend(danmuStore, true);
            saveToLocal.set('twikoo-danmu', danmuStore, 0.5)
          }
          //- 格式化评论
          function formatDanmaku(str) {
            str = str.replace(/<\/*br>|[\s\uFEFF\xA0]+/g, '');
            str = str.replace(/<img.*?>/g, '[图片]');
            str = str.replace(/<a.*?>.*?<\/a>/g, '[链接]');
            str = str.replace(/<pre.*?>.*?<\/pre>/g, '[代码块]');
            str = str.replace(/<.*?>/g, '');
            return str
          }
        } else {
          Danmaku.batchSend(danmuStore, true);
        }
      } catch (err) {
        console.error("Error fetching data:", err);
      }

      document.getElementById('danmu-Btn') && (document.getElementById('danmu-Btn').innerHTML = `<button class="hide-Btn" onclick="document.getElementById('danmu-wrap').classList.remove('hide-danmu')">显示弹幕</button> <button class="hide-Btn" onclick="document.getElementById('danmu-wrap').classList.add('hide-danmu')">隐藏弹幕</button>`)
    }
    (async () => {
      if (typeof EasyDanmaku === 'function') {
        await naokuo_danmu();
      } else {
        const easyDanmakuScript = await getScript('https://npm.onmicrosoft.cn/naokuo-blog@1.2.12/js/easy-Danmaku.js');
        if (typeof EasyDanmaku === 'function') {
          await naokuo_danmu();
        } else {
          console.error('EasyDanmaku function not found even after loading the script.');
        }
      }
    })();
  }
  getnaokuo_danmu()
  document.addEventListener('pjax:complete', getnaokuo_danmu)
})</script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>