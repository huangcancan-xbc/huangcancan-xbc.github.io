<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>025 理解文件系统 | 小米里的大麦</title><meta name="keywords" content="Linux"><meta name="author" content="小米里的大麦"><meta name="copyright" content="小米里的大麦"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="025 理解文件系统"><meta name="application-name" content="025 理解文件系统"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="025 理解文件系统"><meta property="og:url" content="https://www.minbit.top/posts/34793.html"><meta property="og:site_name" content="小米里的大麦"><meta property="og:description" content="理解文件系统1. 认识磁盘磁带由于磁盘磁带和操作系统组成原理更相关，而且相关概念用语言太抽象，所以我找到了一些比较好的视频和书籍内容来帮助理解（注意视频、书籍内容有部分知识我们不涉及，所以不懂也没关系，多出的就当是眼界扩展了）：  硬盘驱动器是如何工作的？（You Tube） 硬盘的工作原理（B 站"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250314131841400.png?_r_=332a269c-0b8e-8288-477f-d8e5d46a82f4"><meta property="article:author" content="小米里的大麦"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250314131841400.png?_r_=332a269c-0b8e-8288-477f-d8e5d46a82f4"><meta name="description" content="理解文件系统1. 认识磁盘磁带由于磁盘磁带和操作系统组成原理更相关，而且相关概念用语言太抽象，所以我找到了一些比较好的视频和书籍内容来帮助理解（注意视频、书籍内容有部分知识我们不涉及，所以不懂也没关系，多出的就当是眼界扩展了）：  硬盘驱动器是如何工作的？（You Tube） 硬盘的工作原理（B 站"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="https://www.minbit.top/posts/34793.html"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="Cd-RTVhRO2mndEhicN2cvLXbsNxPqFC6fSn6ql80eVg"/><meta name="baidu-site-verification" content="codeva-ZG3S9QTvGO"/><meta name="msvalidate.01" content="6DF744D82FE6D1FD11CE18658760B59D"/><meta name="baidu-site-verification" content="codeva-gIjOMzUuhV"/><link rel="manifest" href="/manifest.json"/><meta name="msapplication-TileColor" content="var(--anzhiyu-main)"/><link rel="mask-icon" href="/img/siteicon/apple-icon-180.png" color="#5bbad5"/><link rel="apple-touch-icon" sizes="180x180" href="/img/siteicon/apple-icon-180.png"/><link rel="apple-touch-icon-precomposed" sizes="180x180" href="/img/siteicon/apple-icon-180.png"/><link rel="icon" type="image/png" sizes="32x32" href="/img/siteicon/32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/img/siteicon/16.png"/><link rel="bookmark" href="/img/siteicon/apple-icon-180.png"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2048-2732.jpg" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2732-2048.jpg" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1668-2388.jpg" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2388-1668.jpg" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1536-2048.jpg" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2048-1536.jpg" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1668-2224.jpg" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2224-1668.jpg" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1620-2160.jpg" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2160-1620.jpg" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1290-2796.jpg" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2796-1290.jpg" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1179-2556.jpg" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2556-1179.jpg" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1284-2778.jpg" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2778-1284.jpg" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1170-2532.jpg" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2532-1170.jpg" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1125-2436.jpg" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2436-1125.jpg" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1242-2688.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2688-1242.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-828-1792.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1792-828.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1242-2208.jpg" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2208-1242.jpg" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-750-1334.jpg" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1334-750.jpg" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-640-1136.jpg" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1136-640.jpg" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: {"enable":true,"title":"友链 + 外链 + 无限进步！欢迎欣赏和贡献！","addFriendPlaceholder":"昵称（请勿包含博客等字样）：\n网站地址（要求博客地址，请勿提交个人主页）：\n头像图片url（请提供尽可能清晰的图片，我会上传到我自己的图床）：\n描述：\n站点截图（可选）：\n"},
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"小米里的大麦","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":4,"basicWordCount":1999,"key":"93d1622eadde491eb0594b68ade51723.kaEiDD6A3KPzb7xv","Referer":"https://www.minbit.top/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: {"enable":true,"ck":"Jp8wwGQpp21utaFQ","LingQueMonitorID":"Jp8ztDRrxmTf7LDj"},
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: 'https://twikoo-olive-one.vercel.app/',
  commentBarrageConfig:{"enable":true,"maxBarrage":10,"barrageTime":5000,"accessToken":"25c96851dd8a790c4819ad4bfbaf153c","mailMd5":"7b12ebc2be80f9159099f6ab0e16573c"},
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: {"mode":"both","api":"https://img2color-go.vercel.app/api?img=","cover_change":true},
  authorStatus: {"skills":["🧐 准备中，就快好了，真的！😭","📚 正在学习中，加油！","🎵 喜欢听音乐，喜欢看动漫"]},
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: 小米里的大麦","link":"链接: ","source":"来源: 小米里的大麦","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-right"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: '小米里的大麦',
  title: '025 理解文件系统',
  postAI: '这篇文章讲述了磁盘磁带的构造和存储、读写的原理，以及硬盘（HDD）和固态硬盘（SSD）的数据存储原理与演进。文章首先介绍了磁盘的物理组成，包括盘片、机械手臂和磁头，以及盘片上的扇区、柱面和分区表。接着，文章解释了文件系统的特性，包括超级区块、inode和数据区块的作用，以及索引式文件系统和FAT文件系统的区别。文章还讨论了磁带、HDD和SSD的数据存储原理，以及HDD未被淘汰的原因。最后，文章深入讲解了文件系统磁盘布局，包括Boot Block、Superblock、Group Descriptor Table、Block Bitmap、Inode Bitmap、Inode Table和Data Blocks的布局和作用，以及创建空文件、写入文件、删除文件和拷贝与删除文件的时间差异。',
  pageFillDescription: '理解文件系统, 1. 认识磁盘磁带, 文件系统特性, 2. 磁带、HDD、SSD 数据存储原理与演进, 小知识, 3. 硬盘 (HDD) 存储原理, 4. 固态硬盘 (SSD) 存储原理, 5. HDD 未被淘汰的原因, 6. 文件系统磁盘布局（重点）, 1. Boot Block（启动块x2F引导块）, 2. Superblock (SB超级块), 3. Group Descriptor Table (GDT块组描述符表), 4. Block Bitmap（块位图）, 5. Inode Bitmap（inode 位图）, 6. Inode Table（inode 表）, 7. Data Blocks（数据块）, 8. 对比记忆, 7. 深入理解（重点）, 1. 创建空文件的过程, 2. 写入文件的过程, 3. 删除文件的过程, 4. 拷贝 vs 删除 的时间差异, 5. 目录的理解, 6. 文件系统中增删查改系统要做什么？, 7. 查看文件的 inode 编号理解文件系统认识磁盘磁带由于磁盘磁带和操作系统组成原理更相关而且相关概念用语言太抽象所以我找到了一些比较好的视频和书籍内容来帮助理解注意视频书籍内容有部分知识我们不涉及所以不懂也没关系多出的就当是眼界扩展了硬盘驱动器是如何工作的硬盘的工作原理站机械硬盘是如何工作的站机械磁盘结构与工作原理详解磁带为何能记录声音主要了解其存储原理相关文章博客园相关文章相关文章摘自操作系统概念精要原书第版页前后真的是很想将内容直接摘过来奈何实在是没找到电子版只能扫描现书将就看吧这里的图片已经排好序直接按照顺序看即可推荐直接去看原书也希望有电子版的进行贡献一下感谢您的开源精神自然也少不了鸟哥啦摘自鸟哥的私房菜基础学习篇第四版页相关内容还是推荐看原书就不过多赘述了首先说明一下磁盘的物理组成整颗磁盘的组成主要有圆形的盘片主要记录数据的部分机械手臂与在机械手臂上的磁头可读写盘片上的数据主轴马达可以转动盘片让机械手臂的磁头在盘片上读写数据从上面我们知道数据储存与读取的重点在于盘片而盘片上的物理组成则为假设此磁盘为单碟片盘片图示请参考第二章图的示意扇区为最小的物理储存单位且依据磁盘设计的不同目前主要有与两种格式将扇区组成一个圆那就是柱面早期的分区主要以柱面为最小分区单位现在的分区通常使用扇区为最小分区单位每个扇区都有其号码喔就好像座位一样磁盘分区表主要有两种格式一种是限制较多的分区表一种是较新且限制较少的分区表分区表中第一个扇区最重要里面有主引导记录及分区表其中占有而分区表则占有分区表除了分区数量扩充较多之外支持的磁盘容量也可以超过至于磁盘的文件名部份基本上所有物理磁盘的文件名都已经被仿真成的格式第一块磁盘文件名为而分区的文件名若以第一块磁盘为例则为除了物理磁盘之外虚拟机的磁盘通常为的格式复习完物理组成后来复习一下磁盘分区吧如前所述以前磁盘分区最小单位经常是柱面但的分区软件已经将最小单位改成扇区了所以容量大小的分区可以切的更细此外由于新的大容量磁盘大多得要使用分区表才能够使用全部的容量因此过去那个的传统磁盘分区表限制就不会存在了不过由于还是有小磁盘啊因此你在处理分区的时候还是得要先查询一下你的分区是的分区还是的分区在第三章的安装中鸟哥建议过强制使用分区喔文件系统特性传统的磁盘与文件系统之应用中一个分区就是只能够被格式化成为一个文件系统所以我们可以说一个文件系统就是一个硬盘分区但是由于新技术的利用例如我们常听到的与软件磁盘阵列这些技术可以将一个分区格式化为多个文件系统例如也能够将多个分区合成一个文件系统所以说目前我们在格式化时已经不再说成针对硬盘分区来格式化了通常我们可以称呼一个可被挂载的数据为一个文件系统而不是一个分区喔那么文件系统是如何运行的呢这与操作系统的文件数据有关较新的操作系统的文件数据除了文件实际内容外通常含有非常多的属性例如操作系统的文件权限与文件属性拥有者丶用户组丶时间参数等文件系统通常会将这两部份的数据分别存放在不同的区块权限与属性放置到中至于实际数据则放置到数据区块中另外还有一个超级区块数据区块会记录整个文件系统的整体信息包括与数据区块的总量使用量剩余量等每个与区块都有编号至于这三个数据的意义可以简略说明如下超级区块记录此文件系统的整体信息包括与数据区块的总量使用量剩余量以及文件系统的格式与相关信息等记录文件的属性一个文件占用一个同时记录此文件的数据所在的区块号码数据区块实际记录文件的内容若文件太大时会占用多个区块由于每个与数据区块都有编号而每个文件都会占用一个内则有文件数据放置的数据区块号码因此我们可以知道的是如果能够找到文件的的话那么自然就会知道这个文件所放置数据的数据区块号码当然也就能够读出该文件的实际数据了这是个比较有效率的作法因为如此一来我们的磁盘就能够在短时间内读取出全部的数据读写的性能比较好啰我们将与数据区块区块用图解来说明一下如下图所示文件系统先格式化出与数据区块的区块假设某一个文件的属性与权限数据是放置到号下图较小方格内而这个记录了文件数据的实际放置点为这四个数据区块号码此时我们的操作系统就能够据此来排列磁盘的读取顺序可以一口气将四个数据区块内容读出来那么数据的读取就如同下图中的箭头所指定的模样了这种数据存取的方法我们称为索引式文件系统那有没有其他的惯用文件系统可以比较一下啊有的那就是我们惯用的盘闪存盘使用的文件系统一般为格式这种格式的文件系统并没有存在所以没有办法将这个文件的所有区块在一开始就读取出来每个区块号码都记录在前一个区块当中他的读取方式有点像下面这样上图中我们假设文件的数据依序写入号这四个号码中但这个文件系统没有办法一口气就知道四个区块的号码他得要一个一个的将区块读出后才会知道下一个区块在何处如果同一个文件数据写入的区块分散的太过厉害时则我们的磁头将无法在磁盘转一圈就读到所有的数据因此磁盘就会多转好几圈才能完整的读取到这个文件的内容常常会听到所谓的碎片整理吧需要碎片整理的原因就是文件写入的区块太过于离散了此时文件读取的性能将会变的很差所致这个时候可以通过碎片整理将同一个文件所属的区块集合在一起这样数据的读取会比较容易啊因此的文件系统需要时不时的碎片整理一下那么是否需要磁盘重整呢由于是索引式文件系统基本上不太需要常常进行碎片整理的但是如果文件系统使用太久常常删除编辑新增文件时那么还是可能会造成文件数据太过于离散的问题此时或许会需要进行重整一下的不过老实说鸟哥倒是没有在操作系统上面进行过文件系统的碎片整理似乎不太需要啦太多了还是看图片吧磁带数据存储原理与演进磁带是最古老的电子数据存储技术之一其介质为带有磁性涂层的长条塑料薄膜数据以磁化痕迹形式记录在磁带上写入时磁头通过控制磁场使带面上的磁性颗粒朝向发生改变分别表示二进制的或读取时固定的磁头感应这些磁化痕迹输出数据磁带基片通常是聚酯薄膜上面涂覆氧化铁或金属磁粉层磁带读取为串行访问速度较慢但容量极大而且成本低廉耐用性高因此常用于海量数据的长期归档和备份小知识固态硬盘不属于磁盘或硬盘因其使用闪存芯片而非磁性介质关系总结磁盘是技术大类磁性存储硬盘是磁盘的现代主流应用日常中磁盘有时被误用作硬盘的同义词但严格意义上前者更广泛对比项硬盘磁盘广义关系说明定义一种使用磁性存储技术的物理存储设备属于磁盘的一种具体类型广义指所有利用磁性记录数据的圆形盘片如软盘硬盘中的盘片硬盘是磁盘的一种具体应用形式磁盘的概念更广泛存储原理通过磁头在高速旋转的磁性盘片上读写数据依赖磁性材料记录数据如硬盘盘片软盘等硬盘的存储基于磁盘的磁性原理常见类型机械硬盘包括硬盘中的盘片软盘早期磁光盘等硬盘是磁盘技术的主流应用之一其他磁盘类型逐渐被淘汰或小众化速度较慢依赖机械转动通常转速取决于类型如软盘速度远低于硬盘硬盘速度优于大多数传统磁盘介质容量大当前主流差异大软盘仅硬盘盘片单碟可达数硬盘是磁盘技术中容量发展的巅峰代表体积便携性体积较大英寸或英寸灵活软盘小巧硬盘盘片不可单独使用磁盘的形态多样硬盘更注重固定存储应用场景电脑服务器等大容量存储需求历史曾用于数据交换软盘临时存储等现硬盘主要用于长期存储硬盘取代了多数传统磁盘的用途价格较低单位容量成本低历史中软盘成本低但现代高性能磁盘如企业级硬盘价格较高硬盘性价比高是磁盘技术的经济化产物发展趋势逐渐被替代但仍在大容量存储中占优传统磁盘技术如软盘已淘汰硬盘技术仍在优化固态硬盘不属于磁盘范畴但硬盘仍是磁性存储的重要选择硬盘存储原理硬盘通过磁性方式在旋转的盘片上存储二进制数据每个盘片表面涂覆磁性材料盘片由主马达高速旋转而机械臂上的磁头在盘片上方移动进行读写盘片表面被划分为同心圆形的磁道和扇区每个扇区通常固定容量如或这些磁道和扇区号构成了数据的物理地址盘片上的微小磁颗粒可以被磁化成两种极性分别代表二进制和写入时磁头在线圈通电后在盘片下方产生磁场将被选区域的小颗粒磁极方向改变以记录信息读取时磁头感知磁性材料的极性排列并将其转换为电信号恢复出数据提供随机访问能力因而读写延迟主要受磁头寻道和盘片旋转时间影响固态硬盘存储原理使用闪存芯片典型的作为存储介质无机械活动部件每个闪存单元是一个带浮栅的晶体管通过存储电荷来保存数据当浮栅中注入电子时晶体管阈值变化被解读为二进制当浮栅不带电子时则被视为二进制写入数据时控制器通常需要先擦除整个块块内所有单元恢复为空状态然后才将新数据写入利用高压使电子通过隧道注入浮栅由于没有机械部件读写速度远快于另一方面闪存擦写次数有限控制器必须使用磨损平衡和等技术均衡使用单元并回收空间总的来说速度高无噪音功耗低但成本相对较高且写入寿命有限未被淘汰的原因虽然性能优秀但凭借成本和容量优势仍不可替代根据权威资料对于大容量冷备份或归档场景经济实惠的依然是首选指出若需要高速频繁访问用处理备份归档或大容量存储时普通硬盘是更好的选择此外技术发展成熟数据恢复难度更低长期保存历史数据也更稳定可靠有些公司可能会将用户长期不访问的数据很多年前的数据从迁移至磁盘从而长期保存数据并节约成本上面我们已经基本上了解了磁盘磁带的构造和存储读写的原理下面就到我的讲解了文件系统磁盘布局重点偏移第块偏移备份存放在每个的第块偏移每个保持一份标记该中哪些数据块已用标记该中哪些已用存放结构文件元数据真正存放文件和目录内容的数据区重复多个注意文件系统第块通常或包含启动加载代码不属于文件系统使用范围仅在可启动分区时有意义整个分区被划分成若干个相同大小的以提高并行性并减少碎片每个包含上述结构一次启动块引导块大小个块通常或作用存放引导代码及分区信息在加载文件系统之前被使用文件系统本身不访问此区域存放位置分区的第块超级块作用文件系统的总控信息记录整个分区的全局属性存放位置分区的第块紧跟之后大小固定关键字段魔数文件系统类型标识如表示块大小数据块大小常见总块数总数据块数总数总数第一个第一个可分配通常为根目录冗余存储备份分布在各的第块防止损坏块组描述符表作用描述每个的布局信息如位图表的位置存放位置紧跟主之后占用若干个块描述符大小个的总大小描述符数向上对齐到关键字段块号指向当前的的块号块号指向当前的的块号起始块号指向当前的的起始块号空闲块数空闲数等统计信息块位图作用位图方式标记本组中各数据块是否已分配存放位置由中的字段指定大小个例如能管理个块标记规则已分配空闲位图作用位图方式标记本组中各是否已分配存放位置由中的字段指定大小个例如可管理个标记规则已分配空闲表作用存储所有文件目录的元信息每个大小通常为或存放位置由中的字段指定长度块关键字段普通文件目录符号链接等访问权限文件大小创建修改访问时间戳直接指针个一级二级三级间接指针数据块作用实际存放用户数据所以的文件在磁盘中存储是将属性和内容分开存储的文件内容数据块文件属性目录保存号文件名的列表普通文件存放文件内容的二进制数据存放位置紧跟在各组的之后直至本组末尾字段作用大小位置记录文件系统的全局信息如总块数数块大小等每个可能有一份副本冗余描述当前的元数据如块位图位图的位置紧接之后标记当前中哪些数据块已被占用占用空闲占用个块按位映射标记当前中哪些已被占用类似占用个块按位映射存储数组每个描述一个文件目录的元数据权限大小数据块指针等占用多个块具体取决于数量实际存储文件数据的块剩余所有块对比记忆记忆作用类比文件系统的总说明书书的目录页描述每个的布局章节的页码索引标记哪些块被占用仓库货架占用表存储文件元信息如权限大小文件的属性卡实际存储文件内容仓库里的货物深入理解重点创建空文件的过程查找空闲遍历位图找到一个空闲初始化在表中找到对应填入文件的属性信息如创建时间权限大小等关联目录项在当前目录文件的数据块中增加一条目录项文件名号写入文件的过程根据文件名找到对应通过目录的数据块中查找号读取内容查看已分配的数据块如果存在空余数据块直接写入若数据块已满遍历块位图找到空闲数据块分配并标记为已用在中的数据块指针数组中记录该数据块号写入数据与数据块的映射关系使用一个元素的数组维护前个元素直接指向个数据块后个元素一级索引二级索引和三级索引用于数据块扩展删除文件的过程标记无效在位图中将对应置为无效标记数据块无效在块位图中将文件使用的数据块置为无效删除映射关系删除对应目录文件中该文件的目录项文件名和号的映射关系注意删除操作只是标记为无效标记为可复用而非真正擦除数据因此短时间内可恢复后续文件操作可能重新分配这些和数据块导致原数据被覆盖这也就是数据恢复的原理删除允许被覆盖为什么是短时间被标记为空闲的号和数据块号可能在新文件或写入时重新分配一旦覆盖原始数据就不可恢复拷贝删除的时间差异拷贝文件慢创建新分配多个数据块写入文件内容复制删除文件快只需修改和块位图不需要物理真实的删除文件内容类比创建文件建楼慢删除文件在楼上写拆字快目录的理解在中一切皆文件目录也属于文件目录有自己的属性信息和数据块内容目录的数据块内容该目录下的文件名与对应号的映射表目录权限无权限无法创建文件无权限无法查看文件列表无权限无法进入目录特别说明文件名不存储在中而是存储在它所在目录文件的数据块中系统通过目录项建立文件名和号的联系文件系统中增删查改系统要做什么操作系统执行的步骤概要新建文件分配数据块更新目录项删除文件块标记无效删除目录项查找文件遍历目录数据块找再查内容修改文件定位追加覆盖数据块查看文件的编号文件名使用者通过文件名访问文件内核通过目录项映射找到',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-05-13 16:30:00',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 10 || hour >= 20
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://github.com/huangcancan-xbc/Drawing-bed/blob/master/Blog/20250307201719879.png?raw=true"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">社交</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://github.com/huangcancan-xbc" title="GitHub"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="GitHub"/><span class="back-menu-item-text">GitHub</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://space.bilibili.com/1918272544" title="哔哩哔哩"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="哔哩哔哩"/><span class="back-menu-item-text">哔哩哔哩</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://gitee.com/huang-cancan-xbc" title="Gitee"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="Gitee"/><span class="back-menu-item-text">Gitee</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">博客</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.csdn.net/Huangcancan666?type=blog" title="CSDN"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="CSDN"/><span class="back-menu-item-text">CSDN</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://juejin.cn/user/3230789931118109" title="稀土掘金"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="稀土掘金"/><span class="back-menu-item-text">稀土掘金</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">小米里的大麦</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/charts/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 统计</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 外链</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li></ul></div></div></div><div id="nav-right"><div id="nav-naoDark"><div class="container"><div class="components"><div class="main-button"><div class="moon"></div><div class="moon"></div><div class="moon"></div></div><div class="daytime-backgrond"></div><div class="daytime-backgrond"></div><div class="daytime-backgrond"></div><div class="cloud"><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div></div><div class="cloud-light"><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div></div><div class="stars"><div class="star big"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star big"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star medium"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star medium"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star small"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star small"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div></div></div></div></div><div class="nav-button only-home" id="travellings_button" title="随机前往一个开往项目网站"><a class="site-page" onclick="anzhiyu.totraveling()" title="随机前往一个开往项目网站" href="javascript:void(0);" rel="external nofollow" data-pjax-state="external"><i class="anzhiyufont anzhiyu-icon-train"></i></a></div><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250403212543768.png" target="_blank"><img class="post-qr-code-img" alt="微信" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250403212543768.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250403212622868.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250403212622868.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/C/" style="font-size: 1.05rem;">C++<sup>8</sup></a><a href="/tags/Git/" style="font-size: 1.05rem;">Git<sup>3</sup></a><a href="/tags/IO/" style="font-size: 1.05rem;">IO<sup>3</sup></a><a href="/tags/Linux/" style="font-size: 1.05rem;">Linux<sup>50</sup></a><a href="/tags/Obsidian/" style="font-size: 1.05rem;">Obsidian<sup>1</sup></a><a href="/tags/STL/" style="font-size: 1.05rem;">STL<sup>2</sup></a><a href="/tags/VS-Code/" style="font-size: 1.05rem;">VS Code<sup>1</sup></a><a href="/tags/%E4%BF%A1%E5%8F%B7/" style="font-size: 1.05rem;">信号<sup>3</sup></a><a href="/tags/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/" style="font-size: 1.05rem;">内存管理<sup>1</sup></a><a href="/tags/%E5%8E%86%E7%A8%8B/" style="font-size: 1.05rem;">历程<sup>1</sup></a><a href="/tags/%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4/" style="font-size: 1.05rem;">地址空间<sup>6</sup></a><a href="/tags/%E6%95%B0%E5%AD%A6/" style="font-size: 1.05rem;">数学<sup>1</sup></a><a href="/tags/%E6%A8%A1%E6%9D%BF/" style="font-size: 1.05rem;">模板<sup>1</sup></a><a href="/tags/%E7%AE%A1%E9%81%93/" style="font-size: 1.05rem;">管道<sup>2</sup></a><a href="/tags/%E7%B1%BB%E4%B8%8E%E5%AF%B9%E8%B1%A1/" style="font-size: 1.05rem;">类与对象<sup>3</sup></a><a href="/tags/%E7%BA%BF%E7%A8%8B/" style="font-size: 1.05rem;">线程<sup>4</sup></a><a href="/tags/%E7%BD%91%E7%AB%99/" style="font-size: 1.05rem;">网站<sup>2</sup></a><a href="/tags/%E7%BD%91%E7%BB%9C/" style="font-size: 1.05rem;">网络<sup>6</sup></a><a href="/tags/%E8%BF%9B%E7%A8%8B/" style="font-size: 1.05rem;">进程<sup>15</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="anzhiyufont anzhiyu-icon-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/09/"><span class="card-archive-list-date">九月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/08/"><span class="card-archive-list-date">八月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">8</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/07/"><span class="card-archive-list-date">七月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">9</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/06/"><span class="card-archive-list-date">六月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">6</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/05/"><span class="card-archive-list-date">五月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">9</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/04/"><span class="card-archive-list-date">四月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">8</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/03/"><span class="card-archive-list-date">三月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">10</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/02/"><span class="card-archive-list-date">二月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">9</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item on" id="consoleCommentBarrage" onclick="anzhiyu.switchCommentBarrage()" title="热评开关"><a class="commentBarrage"><i class="anzhiyufont anzhiyu-icon-message"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div><div id="console-naoDark"><div class="container"><div class="components"><div class="main-button"><div class="moon"></div><div class="moon"></div><div class="moon"></div></div><div class="daytime-backgrond"></div><div class="daytime-backgrond"></div><div class="daytime-backgrond"></div><div class="cloud"><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div></div><div class="cloud-light"><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div></div><div class="stars"><div class="star big"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star big"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star medium"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star medium"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star small"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star small"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div></div></div></div></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/Linux/" itemprop="url">Linux</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/Linux/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Linux</span></a></span></div></div><h1 class="post-title" itemprop="name headline">025 理解文件系统</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2025-05-13T08:30:00.000Z" title="发表于 2025-05-13 16:30:00">2025-05-13</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2025-05-13T08:30:00.000Z" title="更新于 2025-05-13 16:30:00">2025-05-13</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">5.9k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>18分钟</span></span><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="025 理解文件系统"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为西安"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>西安</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250314131841400.png?_r_=332a269c-0b8e-8288-477f-d8e5d46a82f4"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><div class="post-ai-description"><div class="ai-title"><i class="anzhiyufont anzhiyu-icon-bilibili"></i><div class="ai-title-text">AI-摘要</div><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right"></i><i class="anzhiyufont anzhiyu-icon-circle-dot" title="朗读摘要"></i><div id="ai-tag">小米里的大麦 GPT</div></div><div class="ai-explanation">AI初始化中...</div><div class="ai-btn-box"><div class="ai-btn-item">介绍自己 🙈</div><div class="ai-btn-item">生成本文简介 👋</div><div class="ai-btn-item">推荐相关文章 📖</div><div class="ai-btn-item">前往主页 🏠</div><div class="ai-btn-item" id="go-tianli-blog">前往爱发电购买</div></div><script data-pjax src="/js/anzhiyu/ai_abstract.js"></script></div><article class="post-content" id="article-container" itemscope itemtype="https://www.minbit.top/posts/34793.html"><header><a class="post-meta-categories" href="/categories/Linux/" itemprop="url">Linux</a><a href="/tags/Linux/" tabindex="-1" itemprop="url">Linux</a><h1 id="CrawlerTitle" itemprop="name headline">025 理解文件系统</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">小米里的大麦</span><time itemprop="dateCreated datePublished" datetime="2025-05-13T08:30:00.000Z" title="发表于 2025-05-13 16:30:00">2025-05-13</time><time itemprop="dateCreated datePublished" datetime="2025-05-13T08:30:00.000Z" title="更新于 2025-05-13 16:30:00">2025-05-13</time></header><h2 id="理解文件系统"><a href="#理解文件系统" class="headerlink" title="理解文件系统"></a>理解文件系统</h2><h3 id="1-认识磁盘磁带"><a href="#1-认识磁盘磁带" class="headerlink" title="1. 认识磁盘磁带"></a>1. 认识磁盘磁带</h3><p><span style="color:#FF0000;"><strong>由于磁盘磁带和操作系统组成原理更相关，而且相关概念用语言太抽象，所以我找到了一些比较好的视频和书籍内容来帮助理解（注意视频、书籍内容有部分知识我们不涉及，所以不懂也没关系，多出的就当是眼界扩展了）：</strong></span></p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=wtdnatmVdIg">硬盘驱动器是如何工作的？（You Tube）</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1iT411o7sW/?spm_id_from=333.337.search-card.all.click&vd_source=47fe2fe2f10c4e806e38c62553037767">硬盘的工作原理（B 站）</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1ug411b7Wo/?spm_id_from=333.337.search-card.all.click&vd_source=47fe2fe2f10c4e806e38c62553037767">机械硬盘是如何工作的？（B 站）</a></p>
<p>→ <a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1J44y1C7RR/?spm_id_from=333.337.search-card.all.click&vd_source=47fe2fe2f10c4e806e38c62553037767">机械磁盘：结构与工作原理详解</a></p>
<p>→ <a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Hz4y1V7RC/?spm_id_from=333.1391.0.0&vd_source=47fe2fe2f10c4e806e38c62553037767">磁带为何能记录声音？（主要了解其存储原理）</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/andy9468/p/11091115.html">相关文章 | 博客园</a></p>
<p><a target="_blank" rel="noopener" href="https://yohifo.blog.csdn.net/article/details/130467665">相关文章 | CSDN</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/chenlong_cxy/article/details/120743720">相关文章 | CSDN</a></p>
</blockquote>
<blockquote>
<p><strong>摘自《操作系统概念精要 原书第 2 版》<code>298</code> 页前后（真的是很想将内容直接摘过来，奈何实在是没找到电子版，只能扫描现书将就看吧 😂）。这里的图片已经排好序，直接按照顺序看即可。推荐直接去看原书，也希望有电子版的进行贡献一下，感谢您的开源精神！</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Linux/20250506203145366.png" alt="image-20250506203138105"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Linux/20250506203307042.jpg" alt="8d8a9a29b2373d90ba4e09a41ccf2bcb"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Linux/20250506203402543.png" alt="image-20250506203402279"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Linux/20250506203527538.png" alt="image-20250506203527455"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Linux/20250506203703851.png" alt="image-20250506203703623"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Linux/20250506203757968.png" alt="image-20250506203757884"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Linux/20250506203840986.png" alt="image-20250506203840852"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Linux/20250506204215684.png" alt="image-20250506204215459"></p>
</blockquote>
<blockquote>
<p><strong>自然也少不了鸟哥啦~ 摘自《鸟哥的 Linux 私房菜 基础学习篇（第四版）》<code>210</code>~&#96;217&#96; 页相关内容。还是推荐看原书，就不过多赘述了。</strong></p>
<p>首先说明一下磁盘的物理组成，整颗磁盘的组成主要有：</p>
<ul>
<li>圆形的盘片（主要记录数据的部分）；</li>
<li>机械手臂，与在机械手臂上的磁头（可读写盘片上的数据）；</li>
<li>主轴马达，可以转动盘片，让机械手臂的磁头在盘片上读写数据。</li>
</ul>
<p>从上面我们知道数据储存与读取的重点在于盘片，而盘片上的物理组成则为（假设此磁盘为单碟片，盘片图示请参考第二章图 2.2.1 的示意）：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Linux/20250506205841943.png" alt="image-20250506205841870"></p>
<ul>
<li>扇区 (Sector)为最小的物理储存单位，且依据磁盘设计的不同，目前主要有 512Bytes 与 4K 两种格式；</li>
<li>将扇区组成一个圆，那就是柱面 (Cylinder) ;</li>
<li>早期的分区主要以柱面为最小分区单位，现在的分区通常使用扇区为最小分区单位（每个扇区都有其号码喔，就好像座位一样）；</li>
<li>磁盘分区表主要有两种格式，一种是限制较多的 MBR 分区表，一种是较新且限制较少的 <code>GPT</code> 分区表。</li>
<li><code>MBR</code> 分区表中，第一个扇区最重要，里面有：主引导记录(Master boot record，MBR)及分区表 (partition table) , 其中 <code>MBR</code> 占有 <code>446B</code>, 而分区表则占有 <code>64B</code>。</li>
<li><code>GPT</code> 分区表除了分区数量扩充较多之外，支持的磁盘容量也可以超过 <code>2TB</code>。</li>
</ul>
<p>至于磁盘的文件名部份，基本上，所有物理磁盘的文件名都已经被仿真成 <code>/dev/sd[a-p]</code> 的格式，第一块磁盘文件名为 <code>/dev/sda</code>。而分区的文件名若以第一块磁盘为例，则为 <code>/dev/sda[1-128]</code>。除了物理磁盘之外，虚拟机的磁盘通常为 <code>/dev/vd[a-p]</code> 的格式。</p>
<p>复习完物理组成后，来复习一下磁盘分区吧！如前所述，以前磁盘分区最小单位经常是柱面，但 CentOS7 的分区软件，已经将最小单位改成扇区了，所以容量大小的分区可以切的更细 〜 此外，由于新的大容量磁盘大多得要使用 <code>GPT</code> 分区表才能够使用全部的容量，因此过去那个 <code>MBR</code> 的传统磁盘分区表限制就不会存在了。不过，由于还是有小磁盘啊！因此，你在处理分区的时候，还是得要先查询一下，你的分区是 <code>MBR</code> 的分区？还是 <code>GPT</code> 的分区？在第三章的 CentOS7 安装中，鸟哥建议过强制使用 <code>GPT</code> 分区喔！</p>
<h4 id="文件系统特性"><a href="#文件系统特性" class="headerlink" title="文件系统特性"></a>文件系统特性</h4><p>传统的磁盘与文件系统之应用中，一个分区就是只能够被格式化成为一个文件系统，所以我们可以说一个文件系统就是一个硬盘分区。但是由于新技术的利用，例如我们常听到的 <code>LVM</code> 与软件磁盘阵列 (softwareraid)，这些技术可以将一个分区格式化为多个文件系统(例如 <code>LVM</code>)，也能够将多个分区合成一个文件系统 (LVM，RAID)。所以说，目前我们在格式化时已经不再说成针对硬盘分区来格式化了，通常我们可以称呼 <strong>一个可被挂载的数据为一个文件系统而不是一个分区喔！</strong></p>
<p>那么文件系统是如何运行的呢？这与操作系统的文件数据有关。较新的操作系统的文件数据除了文件实际内容外，通常含有非常多的属性，例如 <code>Linux</code> 操作系统的文件权限 (<code>rwx</code>)与文件属性（拥有者丶用户组丶时间参数等）。<strong>文件系统通常会将这两部份的数据分别存放在不同的区块，权限与属性放置到 <code>inode</code> 中，至于实际数据则放置到数据区块中。</strong> 另外，还有一个超级区块 (super 数据区块) 会记录整个文件系统的整体信息，包括 <code>inode</code> 与数据区块的总量、使用量、剩余量等。</p>
<p><strong>每个 <code>inode</code> 与区块都有编号，至于这三个数据的意义可以简略说明如下：</strong></p>
<ul>
<li><strong>超级区块 ∶ 记录此 f 文件系统的整体信息，包括 <code>inode</code> 与数据区块的总量、使用量、剩余量，以及文件系统的格式与相关信息等；</strong></li>
<li><strong><code>inode</code>：记录文件的属性，一个文件占用一个 <code>inode</code>，同时记录此文件的数据所在的区块号码；</strong></li>
<li><strong>数据区块：实际记录文件的内容，若文件太大时，会占用多个区块。</strong></li>
</ul>
<p>由于每个 <code>inode</code> 与数据区块都有编号，而每个文件都会占用一个 <code>inode </code>，<code>inode</code> 内则有文件数据放置的数据区块号码。因此，我们可以知道的是，如果能够找到文件的 <code>inode</code> 的话，那么自然就会知道这个文件所放置数据的数据区块号码，当然也就能够读出该文件的实际数据了。这是个比较有效率的作法，因为如此一来我们的磁盘就能够在短时间内读取出全部的数据，读写的性能比较好啰。</p>
<p>我们将 <code>inode</code> 与数据区块区块用图解来说明一下，如下图所示，文件系统先格式化出 <code>inode</code> 与数据区块的区块，假设某一个文件的属性与权限数据是放置到 <code>inode 4</code> 号（下图较小方格内），而这个 <code>inode</code> 记录了文件数据的实际放置点为 2，7，13，15 这四个数据区块号码，此时我们的操作系统就能够据此来排列磁盘的读取顺序，可以一口气将四个数据区块内容读出来！那么数据的读取就如同下图中的箭头所指定的模样了。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Linux/20250506212506040.png" alt="image-20250506212505957"></p>
<p>这种数据存取的方法我们称为索引式文件系统 (indexed allocation)。那有没有其他的惯用文件系统可以比较一下啊？有的，那就是我们惯用的 U 盘（闪存），U 盘使用的文件系统一般为 <code>FAT</code> 格式。<code>FAT</code> 这种格式的文件系统并没有 <code>inode</code> 存在，所以 <code>FAT</code> 没有办法将这个文件的所有区块在一开始就读取出来。每个区块号码都记录在前一个区块当中，他的读取方式有点像下面这样：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Linux/20250506212829231.png" alt="image-20250506212829181"></p>
<p>上图中我们假设文件的数据依序写入 <code>1-&gt;7-&gt;4-&gt;15</code> 号这四个 block 号码中，但这个文件系统没有办法一口气就知道四个区块的号码，他得要一个一个的将区块读出后，才会知道下一个区块在何处。如果同一个文件数据写入的区块分散的太过厉害时，则我们的磁头将无法在磁盘转一圈就读到所有的数据，因此磁盘就会多转好几圈才能完整的读取到这个文件的内容！</p>
<p>常常会听到所谓的碎片整理吧？<strong>需要碎片整理的原因就是文件写入的区块太过于离散了，此时文件读取的性能将会变的很差所致。</strong> 这个时候 <strong>可以通过碎片整理将同一个文件所属的区块集合在一起，这样数据的读取会比较容易啊！</strong> 因此，<code>FAT</code> 的文件系统需要时不时的碎片整理一下，那么 <code>Ext2</code> 是否需要磁盘重整呢？</p>
<p>由于 <code>Ext2</code> 是索引式文件系统，基本上不太需要常常进行碎片整理的。但是如果文件系统使用太久，常常删除、编辑、新增文件时，那么还是可能会造成文件数据太过于离散的问题，此时或许会需要进行重整一下的。不过，老实说，鸟哥倒是没有在 <code>Linux</code> 操作系统上面进行过 <code>Ext2</code>&#x2F;<code>Ext3 </code> 文件系统的碎片整理，似乎不太需要啦！</p>
<hr>
<p>太多了，还是看图片吧 😂</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Linux/20250506214005907.png" alt="image-20250506214005755"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Linux/20250506214113327.png" alt="image-20250506214113160"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Linux/20250506214325829.png" alt="image-20250506214325696"></p>
</blockquote>
<hr>
<h3 id="2-磁带、HDD、SSD-数据存储原理与演进"><a href="#2-磁带、HDD、SSD-数据存储原理与演进" class="headerlink" title="2. 磁带、HDD、SSD 数据存储原理与演进"></a>2. 磁带、HDD、SSD 数据存储原理与演进</h3><p>磁带是最古老的电子数据存储技术之一，其介质为带有磁性涂层的长条塑料薄膜。数据以磁化痕迹形式记录在磁带上：写入时磁头通过控制磁场使带面上的磁性颗粒朝向发生改变，分别表示二进制的 0 或 1；读取时固定的磁头感应这些磁化痕迹输出数据。磁带基片通常是聚酯薄膜，上面涂覆氧化铁或金属磁粉层。磁带读取为串行访问，速度较慢但容量极大，而且成本低廉、耐用性高，因此常用于海量数据的长期归档和备份。</p>
<h4 id="小知识"><a href="#小知识" class="headerlink" title="小知识"></a>小知识</h4><ol>
<li><strong>固态硬盘（SSD）</strong>：不属于磁盘或硬盘（HDD），因其使用闪存芯片而非磁性介质。  </li>
<li><strong>关系总结</strong>：  <ul>
<li><strong>磁盘</strong> 是技术大类（磁性存储），<strong>硬盘</strong> 是磁盘的现代主流应用。  </li>
<li>日常中“磁盘”有时被误用作“硬盘”的同义词，但严格意义上前者更广泛。</li>
</ul>
</li>
</ol>
<table>
<thead>
<tr>
<th><strong>对比项</strong></th>
<th><strong>硬盘（HDD, Hard Disk Drive）</strong></th>
<th><strong>磁盘（广义）</strong></th>
<th><strong>关系说明</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>定义</strong></td>
<td>一种使用磁性存储技术的物理存储设备，属于磁盘的一种具体类型。</td>
<td>广义指所有利用磁性记录数据的圆形盘片（如软盘、硬盘中的盘片）。</td>
<td>硬盘是磁盘的一种具体应用形式，磁盘的概念更广泛。</td>
</tr>
<tr>
<td><strong>存储原理</strong></td>
<td>通过磁头在高速旋转的磁性盘片上读写数据。</td>
<td>依赖磁性材料记录数据（如硬盘盘片、软盘等）。</td>
<td>硬盘的存储基于磁盘的磁性原理。</td>
</tr>
<tr>
<td><strong>常见类型</strong></td>
<td>机械硬盘（<code>HDD</code>）</td>
<td>包括硬盘中的盘片、软盘（<code>Floppy Disk</code>）、早期磁光盘（<code>MO</code>）等。</td>
<td>硬盘是磁盘技术的主流应用之一，其他磁盘类型逐渐被淘汰或小众化。</td>
</tr>
<tr>
<td><strong>速度</strong></td>
<td>较慢（依赖机械转动，通常转速 5400&#x2F;7200 RPM）。</td>
<td>取决于类型（如软盘速度远低于硬盘）。</td>
<td>硬盘速度优于大多数传统磁盘介质。</td>
</tr>
<tr>
<td><strong>容量</strong></td>
<td>大（当前主流 1TB~20TB）。</td>
<td>差异大（软盘仅 1.44MB，硬盘盘片单碟可达数 TB）。</td>
<td>硬盘是磁盘技术中容量发展的巅峰代表。</td>
</tr>
<tr>
<td><strong>体积&#x2F;便携性</strong></td>
<td>体积较大（3.5 英寸或 2.5 英寸）。</td>
<td>灵活（软盘小巧，硬盘盘片不可单独使用）。</td>
<td>磁盘的形态多样，硬盘更注重固定存储。</td>
</tr>
<tr>
<td><strong>应用场景</strong></td>
<td>电脑、服务器等大容量存储需求。</td>
<td>历史曾用于数据交换（软盘）、临时存储等，现硬盘主要用于长期存储。</td>
<td>硬盘取代了多数传统磁盘的用途。</td>
</tr>
<tr>
<td><strong>价格</strong></td>
<td>较低（单位容量成本低）。</td>
<td>历史中软盘成本低，但现代高性能磁盘（如企业级硬盘）价格较高。</td>
<td>硬盘性价比高，是磁盘技术的经济化产物。</td>
</tr>
<tr>
<td><strong>发展趋势</strong></td>
<td>逐渐被 <code>SSD</code> 替代，但仍在大容量存储中占优。</td>
<td>传统磁盘技术（如软盘）已淘汰，硬盘技术仍在优化。</td>
<td><code>SSD</code>（固态硬盘）不属于磁盘范畴，但硬盘仍是磁性存储的重要选择。</td>
</tr>
</tbody></table>
<h3 id="3-硬盘-HDD-存储原理"><a href="#3-硬盘-HDD-存储原理" class="headerlink" title="3. 硬盘 (HDD) 存储原理"></a>3. 硬盘 (HDD) 存储原理</h3><p><strong>硬盘通过磁性方式在旋转的盘片上存储二进制数据。</strong> 每个盘片表面涂覆磁性材料，盘片由主马达高速旋转，而机械臂上的磁头在盘片上方移动进行读写。<strong>盘片表面被划分为同心圆形的磁道（track）和扇区（sector）</strong>，每个扇区通常固定容量（如 <code>512B</code> 或 <code>4096B</code>）；这些磁道和扇区号构成了数据的物理地址。盘片上的微小磁颗粒可以被磁化成两种极性，分别代表二进制 <code>0</code> 和 <code>1</code>。写入时，磁头在线圈通电后在盘片下方产生磁场，将被选区域的小颗粒磁极方向改变以记录信息；读取时，磁头感知磁性材料的极性排列并将其转换为电信号恢复出数据。<code>HDD</code> 提供随机访问能力，因而读写延迟主要受磁头寻道和盘片旋转时间影响。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://github.com/huangcancan-xbc/Drawing-bed/blob/master/Linux/20250506231436727.png?raw=true"></p>
<h3 id="4-固态硬盘-SSD-存储原理"><a href="#4-固态硬盘-SSD-存储原理" class="headerlink" title="4. 固态硬盘 (SSD) 存储原理"></a>4. 固态硬盘 (SSD) 存储原理</h3><p><code>SSD</code> 使用闪存芯片（典型的 <code>NAND Flash</code>）作为存储介质，无机械活动部件。每个闪存单元是一个带浮栅的 <code>MOSFET</code> 晶体管，通过存储电荷来保存数据。当浮栅中注入电子时，晶体管阈值变化被解读为二进制“0”；当浮栅不带电子时则被视为二进制“1”。SSD 写入数据时，控制器通常需要先擦除整个块（块内所有单元恢复为空状态），然后才将新数据写入（利用高压使电子通过隧道注入浮栅）。由于没有机械部件，<code>SSD</code> 读写速度远快于 <code>HDD</code>。另一方面，闪存擦写次数有限，<code>SSD</code> 控制器必须使用磨损平衡（<code>wear leveling</code>）和 <code>TRIM</code> 等技术均衡使用单元并回收空间。总的来说，<code>SSD</code> 速度高、无噪音、功耗低，但成本相对较高且写入寿命有限。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Linux/20250506231741339.png" alt="image-20250506231740872"></p>
<h3 id="5-HDD-未被淘汰的原因"><a href="#5-HDD-未被淘汰的原因" class="headerlink" title="5. HDD 未被淘汰的原因"></a>5. HDD 未被淘汰的原因</h3><p>虽然 <code>SSD</code> 性能优秀，但 <code>HDD</code> 凭借成本和容量优势仍不可替代。根据权威资料，对于大容量、冷备份或归档场景，经济实惠的 <code>HDD</code> 依然是首选。<code>AWS</code> 指出“若需要高速频繁访问用 <code>SSD</code>；处理备份、归档或大容量存储时，普通硬盘是更好的选择”。此外，<code>HDD</code> 技术发展成熟，数据恢复难度更低，长期保存历史数据也更稳定可靠。有些公司可能会将用户长期不访问的数据&#x2F;很多年前的数据从 <code>SSD</code> 迁移至磁盘，从而长期保存数据并节约成本。</p>
<hr>
<p>上面我们已经基本上了解了磁盘磁带的构造和存储、读写的原理，下面就到我的讲解了：</p>
<h3 id="6-文件系统磁盘布局（重点）"><a href="#6-文件系统磁盘布局（重点）" class="headerlink" title="6. 文件系统磁盘布局（重点）"></a>6. 文件系统磁盘布局（重点）</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Linux/20250507122425503.png" alt="image-20250507122425391"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Linux/20250507122324688.png" alt="image-20250507122324436"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">+----------------------+  &lt;- 偏移 0</span><br><span class="line">|     Boot Block       |       (第 0 块, 1KB/2KB/4KB)</span><br><span class="line">+----------------------+  &lt;- 偏移 BLOCK_SIZE</span><br><span class="line">|    Superblock (SB)   |       (备份 SB 存放在每个 Block Group 的第 0/1/2 块)</span><br><span class="line">+----------------------+  &lt;- 偏移 BLOCK_SIZE + sizeof(SB)</span><br><span class="line">| Group Descriptor Tbl |       (每个 Block Group 保持一份)</span><br><span class="line">+----------------------|</span><br><span class="line">| Block Bitmap         |       (标记该 Group 中哪些数据块已用)</span><br><span class="line">+----------------------|</span><br><span class="line">| Inode Bitmap         |       (标记该 Group 中哪些 inode 已用)</span><br><span class="line">+----------------------|</span><br><span class="line">| Inode Table          |       (存放 inode 结构，文件元数据)</span><br><span class="line">+----------------------|</span><br><span class="line">| Data Blocks          |       (真正存放文件和目录内容的数据区)  </span><br><span class="line">|                      |</span><br><span class="line">|                      |</span><br><span class="line">+----------------------+</span><br><span class="line">      …（重复多个 Block Group）…</span><br></pre></td></tr></table></figure>

<p><strong>注意：</strong></p>
<ul>
<li><strong><code>Boot Block</code>：文件系统第 <code>0</code> 块（通常 <code>1KB</code> 或 <code>2KB</code>），包含启动加载代码，不属于文件系统使用范围，仅在可启动分区时有意义。</strong></li>
<li><strong><code>Block Group</code>：整个分区被划分成若干个相同大小的 <code>Block Group</code>，以提高并行性并减少碎片。每个 <code>Group</code> 包含上述结构一次。</strong></li>
</ul>
<hr>
<h4 id="1-Boot-Block（启动块-引导块）"><a href="#1-Boot-Block（启动块-引导块）" class="headerlink" title="1. Boot Block（启动块&#x2F;引导块）"></a>1. Boot Block（启动块&#x2F;引导块）</h4><ul>
<li><strong>大小</strong>：<code>1</code> 个块（<code>BLOCK_SIZE</code>），通常 <code>512B</code> 或 <code>4KB</code>。</li>
<li><strong>作用</strong>：存放引导代码（<code>Bootloader</code>）及分区信息，在 <code>BIOS/UEFI</code> 加载文件系统之前被使用，文件系统本身不访问此区域。</li>
<li><strong>存放位置</strong>：分区的第 <code>0</code> 块。</li>
</ul>
<h4 id="2-Superblock-SB，超级块"><a href="#2-Superblock-SB，超级块" class="headerlink" title="2. Superblock (SB，超级块)"></a>2. Superblock (SB，超级块)</h4><ul>
<li><strong>作用</strong>：文件系统的“总控信息”，记录整个分区的全局属性。</li>
<li><strong>存放位置</strong>：分区的第 <code>1</code> 块（紧跟 <code>Boot Block</code> 之后）。</li>
<li><strong>大小</strong>：固定 <code>1024 B</code>。</li>
<li><strong>关键字段</strong>：<ul>
<li><strong>Magic Number（魔数）</strong>：文件系统类型标识（如 <code>0xEF53</code> 表示 Ext2&#x2F;3&#x2F;4）。</li>
<li><strong>Block Size（块大小）</strong>：数据块大小（常见 <code>4KB</code>）。</li>
<li><strong>Total Blocks（总块数）</strong>：总数据块数。</li>
<li><strong>Total Inodes（总 <code>inode</code> 数）</strong>：总 <code>inode</code> 数。</li>
<li><strong>First Inode（第一个 <code>inode</code>）</strong>：第一个可分配 <code>inode</code>（通常 <code>inode 2</code> 为根目录）。</li>
</ul>
</li>
<li><strong>冗余存储</strong>：备份 <code>Superblock</code> 分布在各 <code>Block Group</code> 的第 <code>0/1/2</code> 块，防止损坏。</li>
</ul>
<hr>
<h4 id="3-Group-Descriptor-Table-GDT，块组描述符表"><a href="#3-Group-Descriptor-Table-GDT，块组描述符表" class="headerlink" title="3. Group Descriptor Table (GDT，块组描述符表)"></a>3. Group Descriptor Table (GDT，块组描述符表)</h4><ul>
<li><strong>作用</strong>：描述每个 <code>Block Group</code> 的布局信息（如位图、<code>inode</code> 表的位置）。</li>
<li><strong>存放位置</strong>：紧跟主 <code>Superblock</code> 之后，占用若干个块。</li>
<li><strong>描述符大小</strong>：32 B&#x2F;个。<code>GroupDescriptorTable</code> 的总大小 &#x3D; 描述符数 × 32，向上对齐到 <code>BLOCK_SIZE</code>。</li>
<li><strong>关键字段</strong>：<ul>
<li><strong><code>block_bitmap</code>（块号）：</strong> 指向当前 <code>Group</code> 的 <code>Block Bitmap</code> 的块号。</li>
<li><strong><code>inode_bitmap</code>（块号）：</strong> 指向当前 <code>Group</code> 的 <code>inode Bitmap</code> 的块号。</li>
<li><strong><code>inode_table</code>（起始块号）：</strong> 指向当前 <code>Group</code> 的 <code>inode Table</code> 的起始块号。</li>
<li>空闲块数、空闲 <code>inode</code> 数等统计信息。</li>
</ul>
</li>
</ul>
<hr>
<h4 id="4-Block-Bitmap（块位图）"><a href="#4-Block-Bitmap（块位图）" class="headerlink" title="4. Block Bitmap（块位图）"></a>4. Block Bitmap（块位图）</h4><ul>
<li><strong>作用</strong>：位图方式标记本组中各数据块是否已分配。</li>
<li><strong>存放位置</strong>：由 <code>GDT</code> 中的 <code>block_bitmap</code> 字段指定。</li>
<li><strong>大小</strong>：1 个 <code>BLOCK_SIZE</code>（例如 4KB &#x3D; 32768 bits，能管理 32768 个块 ≈128MB）。</li>
<li><strong>标记规则</strong>：1 &#x3D; 已分配，0 &#x3D; 空闲。</li>
</ul>
<hr>
<h4 id="5-Inode-Bitmap（inode-位图）"><a href="#5-Inode-Bitmap（inode-位图）" class="headerlink" title="5. Inode Bitmap（inode 位图）"></a>5. Inode Bitmap（inode 位图）</h4><ul>
<li><strong>作用</strong>：位图方式标记本组中各 <code>inode</code> 是否已分配。</li>
<li><strong>存放位置</strong>：由 <code>GDT</code> 中的 <code>inode_bitmap</code> 字段指定。</li>
<li><strong>大小</strong>：1 个 <code>BLOCK_SIZE</code>（例如 <code>4KB</code> 可管理 <code>32768</code> 个 <code>inode</code>）。</li>
<li><strong>标记规则</strong>：1 &#x3D; 已分配，0 &#x3D; 空闲。</li>
</ul>
<hr>
<h4 id="6-Inode-Table（inode-表）"><a href="#6-Inode-Table（inode-表）" class="headerlink" title="6. Inode Table（inode 表）"></a>6. Inode Table（inode 表）</h4><ul>
<li><strong>作用</strong>：存储所有文件&#x2F;目录的元信息，每个 <code>inode</code> 大小通常为 <code>128B</code> 或 <code>256B</code>。</li>
<li><strong>存放位置</strong>：由 <code>GDT</code> 中的 <code>inode_table</code> 字段指定，长度 &#x3D; <code>(inodes_per_group * inode_size) / BLOCK_SIZE</code> 块。</li>
<li><strong>关键字段</strong>：<ul>
<li><strong>File Type</strong>：普通文件、目录、符号链接等。</li>
<li><strong>Permissions</strong>：访问权限（rwx）。</li>
<li><strong>File Size</strong>：文件大小。</li>
<li><strong>Timestamps</strong>：创建&#x2F;修改&#x2F;访问 时间戳。</li>
<li><strong>Data Block Pointers</strong>：直接指针（12 个）、一级&#x2F;二级&#x2F;三级间接指针。</li>
</ul>
</li>
</ul>
<hr>
<h4 id="7-Data-Blocks（数据块）"><a href="#7-Data-Blocks（数据块）" class="headerlink" title="7. Data Blocks（数据块）"></a>7. Data Blocks（数据块）</h4><ul>
<li><strong>作用</strong>：实际存放用户数据。<strong><span style="color:#FF0000;">所以，Linux 的文件在磁盘中存储是将属性和内容分开存储的！（文件内容 → 数据块，文件属性 → <code>inode</code>）</span></strong><ul>
<li><strong>目录（directory）</strong>：保存 <code>&lt;inode号, 文件名&gt;</code> 的列表。</li>
<li><strong>普通文件（file）</strong>：存放文件内容的二进制数据。</li>
</ul>
</li>
<li><strong>存放位置</strong>：紧跟在各组的 <code>Inode Table</code> 之后，直至本组末尾。</li>
</ul>
<table>
<thead>
<tr>
<th>Block Group 字段</th>
<th>作用</th>
<th>大小&#x2F;位置</th>
</tr>
</thead>
<tbody><tr>
<td><strong>SuperBlock</strong></td>
<td>记录文件系统的全局信息（如总块数、<code>inode</code> 数、块大小等）。</td>
<td>每个 <code>Group</code> 可能有一份副本（冗余）。</td>
</tr>
<tr>
<td><strong>Group Descriptor Table</strong></td>
<td>描述当前 <code>Block Group</code> 的元数据（如块位图、<code>inode</code> 位图的位置）。</td>
<td>紧接 <code>SuperBlock</code> 之后。</td>
</tr>
<tr>
<td><strong>Block Bitmap</strong></td>
<td>标记当前 <code>Group</code> 中哪些数据块已被占用（1 &#x3D; 占用，0 &#x3D; 空闲）。</td>
<td>占用 1 个块，按位映射。</td>
</tr>
<tr>
<td><strong>inode Bitmap</strong></td>
<td>标记当前 <code>Group</code> 中哪些 <code>inode</code> 已被占用（类似 <code>Block Bitmap</code>）。</td>
<td>占用 1 个块，按位映射。</td>
</tr>
<tr>
<td><strong>inode Table</strong></td>
<td>存储 <code>inode</code> 数组，每个 <code>inode</code> 描述一个文件&#x2F;目录的元数据（权限、大小、数据块指针等）。</td>
<td>占用多个块，具体取决于 <code>inode</code> 数量。</td>
</tr>
<tr>
<td><strong>Data Blocks</strong></td>
<td>实际存储文件数据的块。</td>
<td>剩余所有块。</td>
</tr>
</tbody></table>
<hr>
<h4 id="8-对比记忆"><a href="#8-对比记忆" class="headerlink" title="8. 对比记忆"></a>8. 对比记忆</h4><table>
<thead>
<tr>
<th>记忆</th>
<th>作用</th>
<th>类比</th>
</tr>
</thead>
<tbody><tr>
<td><strong>SuperBlock</strong></td>
<td>文件系统的“总说明书”。</td>
<td>书的目录页。</td>
</tr>
<tr>
<td><strong>Group Descriptor Table</strong></td>
<td>描述每个 <code>Block Group</code> 的布局。</td>
<td>章节的页码索引。</td>
</tr>
<tr>
<td><strong>Block Bitmap</strong></td>
<td>标记哪些块被占用。</td>
<td>仓库货架占用表。</td>
</tr>
<tr>
<td><strong>inode Table</strong></td>
<td>存储文件元信息（如权限、大小）。</td>
<td>文件的属性卡。</td>
</tr>
<tr>
<td><strong>Data Blocks</strong></td>
<td>实际存储文件内容。</td>
<td>仓库里的货物。</td>
</tr>
</tbody></table>
<hr>
<h3 id="7-深入理解（重点）"><a href="#7-深入理解（重点）" class="headerlink" title="7. 深入理解（重点）"></a>7. 深入理解（重点）</h3><h4 id="1-创建空文件的过程"><a href="#1-创建空文件的过程" class="headerlink" title="1. 创建空文件的过程"></a>1. 创建空文件的过程</h4><ol>
<li><strong>查找空闲 inode</strong>：遍历 <code>inode</code> 位图，找到一个空闲 <code>inode</code>。</li>
<li><strong>初始化 inode</strong>：在 <code>inode</code> 表中找到对应 <code>inode</code>，填入文件的属性信息（如创建时间、权限、大小等）。</li>
<li><strong>关联目录项</strong>：在当前目录文件的数据块中，增加一条目录项（文件名 + <code>inode</code> 号）。</li>
</ol>
<h4 id="2-写入文件的过程"><a href="#2-写入文件的过程" class="headerlink" title="2. 写入文件的过程"></a>2. 写入文件的过程</h4><ol>
<li>根据文件名找到对应 <code>inode</code>（通过目录的数据块中查找 <code>inode</code> 号）。</li>
<li>读取 <code>inode</code> 内容，查看已分配的数据块。</li>
<li>如果存在空余数据块，直接写入。</li>
<li>若数据块已满：<ul>
<li>遍历块位图找到空闲数据块，分配并标记为已用。</li>
<li>在 <code>inode</code> 中的数据块指针数组中记录该数据块号。</li>
<li>写入数据。</li>
</ul>
</li>
</ol>
<p><strong><code>inode</code> 与数据块的映射关系：</strong></p>
<p>使用一个 <code>15</code> 元素的数组维护：</p>
<ul>
<li>前 <code>12</code> 个元素：直接指向 <code>12</code> 个数据块</li>
<li>后 <code>3</code> 个元素：一级索引、二级索引和三级索引（用于数据块扩展）</li>
</ul>
<hr>
<h4 id="3-删除文件的过程"><a href="#3-删除文件的过程" class="headerlink" title="3. 删除文件的过程"></a>3. 删除文件的过程</h4><ol>
<li><strong>标记 <code>inode</code> 无效</strong>：在 <code>inode</code> 位图中将对应 <code>inode</code> 置为无效。</li>
<li><strong>标记数据块无效</strong>：在块位图中将文件使用的数据块置为无效。</li>
<li><strong>删除映射关系：</strong> 删除对应目录文件中该文件的目录项（文件名和 <code>inode</code> 号的映射关系）。</li>
</ol>
<blockquote>
<p>  <strong>注意：删除操作只是标记为无效（标记为“可复用”）而非真正擦除数据，因此短时间内可恢复。后续文件操作可能重新分配这些 <code>inode</code> 和数据块，导致原数据被覆盖。这也就是数据恢复的原理：删除 &#x3D; 允许被覆盖。</strong></p>
</blockquote>
<p><strong>为什么是“短时间”？</strong></p>
<ul>
<li>被标记为空闲的 <code>inode</code> 号和数据块号可能在新文件或写入时重新分配。</li>
<li>一旦覆盖，原始数据就不可恢复。</li>
</ul>
<hr>
<h4 id="4-拷贝-vs-删除-的时间差异"><a href="#4-拷贝-vs-删除-的时间差异" class="headerlink" title="4. 拷贝 vs 删除 的时间差异"></a>4. 拷贝 vs 删除 的时间差异</h4><ul>
<li><strong>拷贝文件慢</strong>：<ul>
<li>创建新 <code>inode</code>。</li>
<li>分配多个数据块。</li>
<li>写入文件内容（复制）。</li>
</ul>
</li>
<li><strong>删除文件快</strong>：<ul>
<li>只需修改 <code>inode</code> 和块位图。</li>
<li>不需要物理&#x2F;真实的删除文件内容。</li>
</ul>
</li>
</ul>
<p><strong>类比：</strong></p>
<ul>
<li>创建文件 &#x3D; 建楼 → 慢</li>
<li>删除文件 &#x3D; 在楼上写“拆”字 → 快</li>
</ul>
<hr>
<h4 id="5-目录的理解"><a href="#5-目录的理解" class="headerlink" title="5. 目录的理解"></a>5. 目录的理解</h4><ul>
<li><strong>在 Linux 中“一切皆文件”，目录也属于文件。</strong></li>
<li>目录有自己的 <code>inode</code>（属性信息）和数据块（内容）。</li>
<li>目录的数据块内容：该目录下的文件名 与 对应 <code>inode</code> 号的映射表。</li>
</ul>
<p><strong>目录权限</strong>：</p>
<ul>
<li>无 <code>w</code> 权限：无法创建文件。</li>
<li>无 <code>r</code> 权限：无法查看文件列表。</li>
<li>无 <code>x</code> 权限：无法进入目录。</li>
</ul>
<p><strong>特别说明：</strong></p>
<ul>
<li>文件名不存储在 <code>inode</code> 中，而是存储在它所在目录文件的数据块中。</li>
<li>系统通过“目录项”建立文件名和 <code>inode</code> 号的联系。</li>
</ul>
<hr>
<h4 id="6-文件系统中增删查改系统要做什么？"><a href="#6-文件系统中增删查改系统要做什么？" class="headerlink" title="6. 文件系统中增删查改系统要做什么？"></a>6. 文件系统中增删查改系统要做什么？</h4><table>
<thead>
<tr>
<th>操作</th>
<th>系统执行的步骤概要</th>
</tr>
</thead>
<tbody><tr>
<td>新建文件</td>
<td>分配 <code>inode</code>、数据块，更新目录项</td>
</tr>
<tr>
<td>删除文件</td>
<td><code>inode</code>&#x2F;块标记无效，删除目录项</td>
</tr>
<tr>
<td>查找文件</td>
<td>遍历目录数据块，找 <code>inode</code>，再查 <code>inode</code> 内容</td>
</tr>
<tr>
<td>修改文件</td>
<td>定位 <code>inode</code>，追加&#x2F;覆盖数据块</td>
</tr>
</tbody></table>
<h4 id="7-查看文件的-inode-编号"><a href="#7-查看文件的-inode-编号" class="headerlink" title="7. 查看文件的 inode 编号"></a>7. 查看文件的 inode 编号</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span> -i 文件名</span><br></pre></td></tr></table></figure>

<ul>
<li>使用者通过文件名访问文件。</li>
<li>内核通过目录项映射找到 inode。</li>
</ul>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://github.com/huangcancan-xbc/Drawing-bed/blob/master/Blog/20250307201719879.png?raw=true" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://github.com/huangcancan-xbc/Drawing-bed/blob/master/Blog/20250307201719879.png?raw=true" title="头像" alt="头像"></a><div class="post-copyright__author_name">小米里的大麦</div><div class="post-copyright__author_desc"></div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://www.minbit.top/posts/34793.html">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('https://www.minbit.top/posts/34793.html')">025 理解文件系统</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250403212543768.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250403212543768.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250403212622868.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250403212622868.png" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://www.minbit.top/posts/34793.html"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=025 理解文件系统&amp;url=https://www.minbit.top/posts/34793.html&amp;pic=https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250314131841400.png?_r_=332a269c-0b8e-8288-477f-d8e5d46a82f4" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">MIT</a> 许可协议。转载请注明来自 <a href="https://www.minbit.top" target="_blank">小米里的大麦</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/Linux/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Linux<span class="tagsPageCount">50</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250314125923408.png?_r_=589997d1-2591-0775-e5e3-4f301a7db57f" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/36108.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250314140243649.png?_r_=dfda3974-5a78-cefe-eb49-623c56872bdc" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">024 基础 IO —— 缓冲区</div></div></a></div><div class="next-post pull-right"><a href="/posts/6239.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250314131841400.png?_r_=6e2809de-72ab-91c9-dcca-2f78f864c121" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">026 inode 与软硬链接</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/posts/55415.html" title="002 创建普通账户（为朋友创建、删除账户）"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250817000335747.png?_r_=1afc30bf-9522-d21e-c511-fb0d5268d01d" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-02-17</div><div class="title">002 创建普通账户（为朋友创建、删除账户）</div></div></a></div><div><a href="/posts/49772.html" title="001 环境搭建"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250314131841400.png?_r_=9ee1bafa-e274-33f1-613b-cf20cefc2127" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-02-11</div><div class="title">001 环境搭建</div></div></a></div><div><a href="/posts/42463.html" title="003 系统和入门指令"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250817000335747.png?_r_=d939bc67-5e7e-b6d8-2dbc-a5d4fdfebdd8" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-02-22</div><div class="title">003 系统和入门指令</div></div></a></div><div><a href="/posts/15646.html" title="006 yum和Linux生态"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250314125923408.png?_r_=7afd205c-337c-0453-4e8f-74036342b67a" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-03-17</div><div class="title">006 yum和Linux生态</div></div></a></div><div><a href="/posts/62462.html" title="007 Linux 开发工具（上）—— vim、解放sudo、gc+"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250314140243649.png?_r_=3002b45c-41db-6654-7ddb-65027b7dfb1e" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-03-17</div><div class="title">007 Linux 开发工具（上）—— vim、解放sudo、gc+</div></div></a></div><div><a href="/posts/9242.html" title="004 Linux基本指令"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250314141714221.png?_r_=441cb07d-893e-bc36-8a9c-1b54f47db664" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-02-28</div><div class="title">004 Linux基本指令</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div><div class="comment-tips" id="comment-tips"><span>✅ 你无需删除空行，直接评论以获取最佳展示效果</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://github.com/huangcancan-xbc/Drawing-bed/blob/master/Blog/20250307201719879.png?raw=true" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/08/24/64e6ce9c507bb.png" alt="status"/></div></div><div class="author-info__description">时间好像总会留下点什么,或许是一个人,或许是一个梦,或许……是一段有意义的经历~</div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">小米里的大麦</h1><div class="author-info__desc"></div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/huangcancan-xbc" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a></div></div></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bullhorn anzhiyu-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来看我的博客鸭~<br>建议优先查看置顶的 <a href="https://www.minbit.top/posts/17934.html">网站说明</a> 哦~</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%90%86%E8%A7%A3%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.</span> <span class="toc-text">理解文件系统</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%AE%A4%E8%AF%86%E7%A3%81%E7%9B%98%E7%A3%81%E5%B8%A6"><span class="toc-number">1.1.</span> <span class="toc-text">1. 认识磁盘磁带</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%89%B9%E6%80%A7"><span class="toc-number">1.1.1.</span> <span class="toc-text">文件系统特性</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%A3%81%E5%B8%A6%E3%80%81HDD%E3%80%81SSD-%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E5%8E%9F%E7%90%86%E4%B8%8E%E6%BC%94%E8%BF%9B"><span class="toc-number">1.2.</span> <span class="toc-text">2. 磁带、HDD、SSD 数据存储原理与演进</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%8F%E7%9F%A5%E8%AF%86"><span class="toc-number">1.2.1.</span> <span class="toc-text">小知识</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%A1%AC%E7%9B%98-HDD-%E5%AD%98%E5%82%A8%E5%8E%9F%E7%90%86"><span class="toc-number">1.3.</span> <span class="toc-text">3. 硬盘 (HDD) 存储原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%9B%BA%E6%80%81%E7%A1%AC%E7%9B%98-SSD-%E5%AD%98%E5%82%A8%E5%8E%9F%E7%90%86"><span class="toc-number">1.4.</span> <span class="toc-text">4. 固态硬盘 (SSD) 存储原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-HDD-%E6%9C%AA%E8%A2%AB%E6%B7%98%E6%B1%B0%E7%9A%84%E5%8E%9F%E5%9B%A0"><span class="toc-number">1.5.</span> <span class="toc-text">5. HDD 未被淘汰的原因</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%A3%81%E7%9B%98%E5%B8%83%E5%B1%80%EF%BC%88%E9%87%8D%E7%82%B9%EF%BC%89"><span class="toc-number">1.6.</span> <span class="toc-text">6. 文件系统磁盘布局（重点）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Boot-Block%EF%BC%88%E5%90%AF%E5%8A%A8%E5%9D%97-%E5%BC%95%E5%AF%BC%E5%9D%97%EF%BC%89"><span class="toc-number">1.6.1.</span> <span class="toc-text">1. Boot Block（启动块&#x2F;引导块）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Superblock-SB%EF%BC%8C%E8%B6%85%E7%BA%A7%E5%9D%97"><span class="toc-number">1.6.2.</span> <span class="toc-text">2. Superblock (SB，超级块)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Group-Descriptor-Table-GDT%EF%BC%8C%E5%9D%97%E7%BB%84%E6%8F%8F%E8%BF%B0%E7%AC%A6%E8%A1%A8"><span class="toc-number">1.6.3.</span> <span class="toc-text">3. Group Descriptor Table (GDT，块组描述符表)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-Block-Bitmap%EF%BC%88%E5%9D%97%E4%BD%8D%E5%9B%BE%EF%BC%89"><span class="toc-number">1.6.4.</span> <span class="toc-text">4. Block Bitmap（块位图）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-Inode-Bitmap%EF%BC%88inode-%E4%BD%8D%E5%9B%BE%EF%BC%89"><span class="toc-number">1.6.5.</span> <span class="toc-text">5. Inode Bitmap（inode 位图）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-Inode-Table%EF%BC%88inode-%E8%A1%A8%EF%BC%89"><span class="toc-number">1.6.6.</span> <span class="toc-text">6. Inode Table（inode 表）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-Data-Blocks%EF%BC%88%E6%95%B0%E6%8D%AE%E5%9D%97%EF%BC%89"><span class="toc-number">1.6.7.</span> <span class="toc-text">7. Data Blocks（数据块）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-%E5%AF%B9%E6%AF%94%E8%AE%B0%E5%BF%86"><span class="toc-number">1.6.8.</span> <span class="toc-text">8. 对比记忆</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%EF%BC%88%E9%87%8D%E7%82%B9%EF%BC%89"><span class="toc-number">1.7.</span> <span class="toc-text">7. 深入理解（重点）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%88%9B%E5%BB%BA%E7%A9%BA%E6%96%87%E4%BB%B6%E7%9A%84%E8%BF%87%E7%A8%8B"><span class="toc-number">1.7.1.</span> <span class="toc-text">1. 创建空文件的过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%86%99%E5%85%A5%E6%96%87%E4%BB%B6%E7%9A%84%E8%BF%87%E7%A8%8B"><span class="toc-number">1.7.2.</span> <span class="toc-text">2. 写入文件的过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6%E7%9A%84%E8%BF%87%E7%A8%8B"><span class="toc-number">1.7.3.</span> <span class="toc-text">3. 删除文件的过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E6%8B%B7%E8%B4%9D-vs-%E5%88%A0%E9%99%A4-%E7%9A%84%E6%97%B6%E9%97%B4%E5%B7%AE%E5%BC%82"><span class="toc-number">1.7.4.</span> <span class="toc-text">4. 拷贝 vs 删除 的时间差异</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E7%9B%AE%E5%BD%95%E7%9A%84%E7%90%86%E8%A7%A3"><span class="toc-number">1.7.5.</span> <span class="toc-text">5. 目录的理解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E4%B8%AD%E5%A2%9E%E5%88%A0%E6%9F%A5%E6%94%B9%E7%B3%BB%E7%BB%9F%E8%A6%81%E5%81%9A%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">1.7.6.</span> <span class="toc-text">6. 文件系统中增删查改系统要做什么？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-%E6%9F%A5%E7%9C%8B%E6%96%87%E4%BB%B6%E7%9A%84-inode-%E7%BC%96%E5%8F%B7"><span class="toc-number">1.7.7.</span> <span class="toc-text">7. 查看文件的 inode 编号</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/62772.html" title="050 传输层 —— UDP"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250314125923408.png?_r_=589997d1-2591-0775-e5e3-4f301a7db57f" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="050 传输层 —— UDP"/></a><div class="content"><a class="title" href="/posts/62772.html" title="050 传输层 —— UDP">050 传输层 —— UDP</a><time datetime="2025-09-12T04:00:00.000Z" title="发表于 2025-09-12 12:00:00">2025-09-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/34998.html" title="049 HTTPS 协议原理"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250314131841400.png?_r_=d20d13f8-c4a1-3018-7b57-dfc505aaf25a" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="049 HTTPS 协议原理"/></a><div class="content"><a class="title" href="/posts/34998.html" title="049 HTTPS 协议原理">049 HTTPS 协议原理</a><time datetime="2025-08-28T04:00:00.000Z" title="发表于 2025-08-28 12:00:00">2025-08-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/63840.html" title="048 HTTP 协议"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250817000335747.png?_r_=d7eeeb88-b375-c1d2-71d2-9fa4ce942e93" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="048 HTTP 协议"/></a><div class="content"><a class="title" href="/posts/63840.html" title="048 HTTP 协议">048 HTTP 协议</a><time datetime="2025-08-25T04:00:00.000Z" title="发表于 2025-08-25 12:00:00">2025-08-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/38905.html" title="047 网络传输基础：TCP 连接建立与数据序列化"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250817000335747.png?_r_=6a0bf21f-d544-710a-2354-ef7b6e11acfb" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="047 网络传输基础：TCP 连接建立与数据序列化"/></a><div class="content"><a class="title" href="/posts/38905.html" title="047 网络传输基础：TCP 连接建立与数据序列化">047 网络传输基础：TCP 连接建立与数据序列化</a><time datetime="2025-08-22T04:00:00.000Z" title="发表于 2025-08-22 12:00:00">2025-08-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/40348.html" title="046 网络编程套接字"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/huangcancan-xbc/Drawing-bed@master/Blog/20250314131841400.png?_r_=235af0ea-4273-916a-faeb-502ab2004876" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="046 网络编程套接字"/></a><div class="content"><a class="title" href="/posts/40348.html" title="046 网络编程套接字">046 网络编程套接字</a><time datetime="2025-08-15T04:00:00.000Z" title="发表于 2025-08-15 12:00:00">2025-08-15</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="footer_deal"><a class="deal_link" href="mailto:hc1960074081@qq.com" title="email"><i class="anzhiyufont anzhiyu-icon-envelope"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://weibo.com/u/7913790969" title="微博"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a><img class="footer_mini_logo" title="返回顶部" alt="返回顶部" onclick="anzhiyu.scrollToDest(0, 500)" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://github.com/huangcancan-xbc/Drawing-bed/blob/master/Blog/20250307201719879.png?raw=true" size="50px"/><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/huangcancan-xbc" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://space.bilibili.com/1918272544" title="Bilibili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a></div></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2025 By <a class="footer-bar-link" href="/" title="小米里的大麦" target="_blank">小米里的大麦</a></div></div><div id="footer-type-tips"></div><div class="js-pjax"><script>function subtitleType () {
  fetch('https://v1.hitokoto.cn')
    .then(response => response.json())
    .then(data => {
      if (true) {
        const from = '出自 ' + data.from
        const sub = ["《左传》载曰：“太上有立德，其次有立功，其次有立言，虽久不废，此之谓不朽。”","纸上得来终觉浅，绝知此事要躬行！","你太专注于未来，却没有意识到，今天正是你多年前祈求的模样，因为你眺望远方视而不见。","梦想是不会发光的，发光的是追梦的你！"]
        sub.unshift(data.hitokoto, from)
        window.typed = new Typed('#footer-type-tips', {
          strings: sub,
          startDelay: 300,
          typeSpeed: 150,
          loop: true,
          backSpeed: 50,
        })
      } else {
        document.getElementById('footer-type-tips').innerHTML = data.hitokoto
      }
    })
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.cbd.int/typed.js@2.1.0/dist/typed.umd.js').then(subtitleType)
  }
} else {
  subtitleType()
}
</script></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/huangcancan-xbc" title="GitHub主页">GitHub主页</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">64</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">19</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">6</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">社交</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://github.com/huangcancan-xbc" title="GitHub"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="GitHub"/><span class="back-menu-item-text">GitHub</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://space.bilibili.com/1918272544" title="哔哩哔哩"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="哔哩哔哩"/><span class="back-menu-item-text">哔哩哔哩</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://gitee.com/huang-cancan-xbc" title="Gitee"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="Gitee"/><span class="back-menu-item-text">Gitee</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">博客</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.csdn.net/Huangcancan666?type=blog" title="CSDN"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="CSDN"/><span class="back-menu-item-text">CSDN</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://juejin.cn/user/3230789931118109" title="稀土掘金"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="稀土掘金"/><span class="back-menu-item-text">稀土掘金</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/charts/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 统计</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 外链</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/C/" style="font-size: 0.88rem;">C++<sup>8</sup></a><a href="/tags/Git/" style="font-size: 0.88rem;">Git<sup>3</sup></a><a href="/tags/IO/" style="font-size: 0.88rem;">IO<sup>3</sup></a><a href="/tags/Linux/" style="font-size: 0.88rem;">Linux<sup>50</sup></a><a href="/tags/Obsidian/" style="font-size: 0.88rem;">Obsidian<sup>1</sup></a><a href="/tags/STL/" style="font-size: 0.88rem;">STL<sup>2</sup></a><a href="/tags/VS-Code/" style="font-size: 0.88rem;">VS Code<sup>1</sup></a><a href="/tags/%E4%BF%A1%E5%8F%B7/" style="font-size: 0.88rem;">信号<sup>3</sup></a><a href="/tags/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/" style="font-size: 0.88rem;">内存管理<sup>1</sup></a><a href="/tags/%E5%8E%86%E7%A8%8B/" style="font-size: 0.88rem;">历程<sup>1</sup></a><a href="/tags/%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4/" style="font-size: 0.88rem;">地址空间<sup>6</sup></a><a href="/tags/%E6%95%B0%E5%AD%A6/" style="font-size: 0.88rem;">数学<sup>1</sup></a><a href="/tags/%E6%A8%A1%E6%9D%BF/" style="font-size: 0.88rem;">模板<sup>1</sup></a><a href="/tags/%E7%AE%A1%E9%81%93/" style="font-size: 0.88rem;">管道<sup>2</sup></a><a href="/tags/%E7%B1%BB%E4%B8%8E%E5%AF%B9%E8%B1%A1/" style="font-size: 0.88rem;">类与对象<sup>3</sup></a><a href="/tags/%E7%BA%BF%E7%A8%8B/" style="font-size: 0.88rem;">线程<sup>4</sup></a><a href="/tags/%E7%BD%91%E7%AB%99/" style="font-size: 0.88rem;">网站<sup>2</sup></a><a href="/tags/%E7%BD%91%E7%BB%9C/" style="font-size: 0.88rem;">网络<sup>6</sup></a><a href="/tags/%E8%BF%9B%E7%A8%8B/" style="font-size: 0.88rem;">进程<sup>15</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><a id="switch-commentBarrage" href="javascript:anzhiyu.switchCommentBarrage();" title="开关弹幕"><i class="anzhiyufont anzhiyu-icon-danmu"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("01/01/2025 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2025 By 安知鱼 V1.6.14",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 小米里的大麦 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://twikoo-olive-one.vercel.app/',
      // 自己额外添加的：
      path: location.pathname.replace(/index\.html$/, ''),
      
      region: 'ap-shanghai',
      onCommentLoaded: () => {
        anzhiyu.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(runFn,0)
    else getScript('https://cdn.cbd.int/twikoo@1.6.44/dist/twikoo.all.min.js').then(runFn)
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo-olive-one.vercel.app/',
      region: 'ap-shanghai',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const runFn = () => {
    init();
    GLOBAL_CONFIG_SITE.isPost && getCount()
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) anzhiyu.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else {
      loadTwikoo()
    }
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"><script async src="/js/anzhiyu/comment_barrage.js"></script></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'https://twikoo-olive-one.vercel.app/',
        region: 'ap-shanghai',
        pageSize: 6,
        includeReply: true
      }).then(function (res) {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        saveToLocal.set('twikoo-newest-comments', JSON.stringify(twikooArray), 10/(60*24))
        generateHtml(twikooArray)
      }).catch(function (err) {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.textContent= "无法获取评论，请确认相关配置是否正确"
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      getScript('https://cdn.cbd.int/twikoo@1.6.44/dist/twikoo.all.min.js').then(runTwikoo)
    }
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'><div class='name'><span>${array[i].nick} </span></div></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom && ($dom.innerHTML= result)
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('twikoo-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.1/bubble/bubble.js"></script><script>var visitorMail = "xiaomilidedamai@minbit.top";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script src="/js/anzhiyu/right_click_menu.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><script src="https://cdn.bootcdn.net/ajax/libs/echarts/4.9.0-rc.1/echarts.min.js"></script><script src="/js/footer-animal.js" defer></script><script id="click-show-text" src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/click-show-text.min.js" data-mobile="false" data-text="offer,暴富,健康,offer,喜乐,成功,offer,好运,自由,offer,坚持,上岸" data-fontsize="20px" data-random="true" async="async"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","meta[property=\"og:type\"]","meta[property=\"og:site_name\"]","meta[property=\"og:description\"]","head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"]):not([href="/music/"]):not([href="/no-pjax/"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script><script>//- 留言板页面弹幕
window.addEventListener('load', () => {
  const getnaokuo_danmu = () => {
    if (!window.location.pathname.startsWith('/comments/')) return; //- 判断是否是留言板页面
    const naokuo_danmu = async () => {
      const Danmaku = new EasyDanmaku({
        page: '/comments/', //- 即留言板地址
        el: '#danmu-wrap', //- 弹幕挂载节点
        line: 5, //- 弹幕行数
        speed: 20, //- 弹幕播放速度
        hover: true, //- 鼠标hover时是否暂停播放弹幕
        loop: false, //- 开启循环播放
        colourful: true, //- 开启彩色弹幕
        coefficient: 1.38, //- 弹幕密度系数
        runtime: 10, //- 循环弹幕播放时长
      });
      try {
        let danmuStore = saveToLocal.get('twikoo-danmu');
        if (!danmuStore) {
          const options = {
            method: "POST",
            body: JSON.stringify({
              "event": "GET_RECENT_COMMENTS",
              "includeReply": false,
              "pageSize": 100
            }),
            headers: { 'Content-Type': 'application/json' }
          }
          danmuStore = [];
          const response = await fetch(`https://twikoo-olive-one.vercel.app/`, options);
          if (response.ok) {
            const { data } = await response.json();
            //- console.info(data);
            data.forEach(i => {
              if (i.avatar == undefined) i.avatar = 'https://cravatar.cn/avatar/d615d5793929e8c7d70eab5f00f7f5f1?d=mp'
              danmuStore.push({ avatar: i.avatar, content: i.nick + '：' + formatDanmaku(i.comment), url: i.url + '#' + i.id })
            });
            Danmaku.batchSend(danmuStore, true);
            saveToLocal.set('twikoo-danmu', danmuStore, 0.5)
          }
          //- 格式化评论
          function formatDanmaku(str) {
            str = str.replace(/<\/*br>|[\s\uFEFF\xA0]+/g, '');
            str = str.replace(/<img.*?>/g, '[图片]');
            str = str.replace(/<a.*?>.*?<\/a>/g, '[链接]');
            str = str.replace(/<pre.*?>.*?<\/pre>/g, '[代码块]');
            str = str.replace(/<.*?>/g, '');
            return str
          }
        } else {
          Danmaku.batchSend(danmuStore, true);
        }
      } catch (err) {
        console.error("Error fetching data:", err);
      }

      document.getElementById('danmu-Btn') && (document.getElementById('danmu-Btn').innerHTML = `<button class="hide-Btn" onclick="document.getElementById('danmu-wrap').classList.remove('hide-danmu')">显示弹幕</button> <button class="hide-Btn" onclick="document.getElementById('danmu-wrap').classList.add('hide-danmu')">隐藏弹幕</button>`)
    }
    (async () => {
      if (typeof EasyDanmaku === 'function') {
        await naokuo_danmu();
      } else {
        const easyDanmakuScript = await getScript('https://npm.onmicrosoft.cn/naokuo-blog@1.2.12/js/easy-Danmaku.js');
        if (typeof EasyDanmaku === 'function') {
          await naokuo_danmu();
        } else {
          console.error('EasyDanmaku function not found even after loading the script.');
        }
      }
    })();
  }
  getnaokuo_danmu()
  document.addEventListener('pjax:complete', getnaokuo_danmu)
})</script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>