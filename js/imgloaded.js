(function(){class i{constructor(e,t){this.smallSrc=e;this.largeSrc=t;this.initTpl();this.container.addEventListener("animationend",()=>{this.smallStage.style.display="none"},{once:true})}initTpl(){this.container=document.createElement("div");this.smallStage=document.createElement("div");this.largeStage=document.createElement("div");this.smallImg=new Image;this.largeImg=new Image;this.container.className="pl-container";this.smallStage.className="pl-img pl-blur";this.largeStage.className="pl-img";this.container.appendChild(this.smallStage);this.container.appendChild(this.largeStage);this.smallImg.onload=this._onSmallLoaded.bind(this);this.largeImg.onload=this._onLargeLoaded.bind(this)}progressiveLoad(){this.smallImg.src=this.smallSrc;this.largeImg.src=this.largeSrc}_onLargeLoaded(){this.largeStage.classList.add("pl-visible");this.largeStage.style.backgroundImage=`url('${this.largeSrc}')`}_onSmallLoaded(){this.smallStage.classList.add("pl-visible");this.smallStage.style.backgroundImage=`url('${this.smallSrc}')`}}const l=(e,t)=>{console.log("执行渐进背景替换");const a=window.matchMedia("(max-width: 767px)").matches;const l=new i(a?e.mobileSmallSrc:e.smallSrc,a?e.mobileLargeSrc:e.largeSrc);if(t.children[0]){t.insertBefore(l.container,t.children[0])}l.progressiveLoad()};const a={light:{smallSrc:"https://blog.xiowo.net/img/bg.svg",largeSrc:"https://blog.xiowo.net/img/bg.svg",mobileSmallSrc:"https://blog.xiowo.net/img/bg.svg",mobileLargeSrc:"https://blog.xiowo.net/img/bg.svg",enableRoutes:["/"]},dark:{smallSrc:"https://blog.xiowo.net/img/bg-dark.jpg",largeSrc:"https://blog.xiowo.net/img/bg-dark.jpg",mobileSmallSrc:"https://blog.xiowo.net/img/bg-dark.jpg",mobileLargeSrc:"https://blog.xiowo.net/img/bg-dark.jpg",enableRoutes:["/"]}};const s=()=>{return document.documentElement.getAttribute("data-theme")};const t=()=>{const e=s();const t=a[e];r(t);document.addEventListener("DOMContentLoaded",function(){r(t)});document.addEventListener("pjax:complete",function(){g(t)})};let e=s();let n=a[e];r(n);const o=new MutationObserver(e=>{e.forEach(e=>{if(e.attributeName==="data-theme"&&location.pathname==="/"){t()}})});o.observe(document.documentElement,{attributes:true,attributeFilter:["data-theme"]});function r(e){const t=document.querySelector(".pl-container");if(t){t.remove()}const a=document.getElementById("page-header");if(a&&a.classList.contains("full_page")){l(e,a)}}function g(e){const t=document.getElementById("page-header");if(t&&t.classList.contains("full_page")){r(e)}}})();